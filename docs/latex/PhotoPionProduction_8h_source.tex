\hypertarget{PhotoPionProduction_8h_source}{}\doxysection{Photo\+Pion\+Production.\+h}
\label{PhotoPionProduction_8h_source}\index{PhotoPionProduction.h@{PhotoPionProduction.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_PHOTOPIONPRODUCTION\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_PHOTOPIONPRODUCTION\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}crpropa/Module.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}crpropa/PhotonBackground.h"{}}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{15 \textcolor{keyword}{struct }\mbox{\hyperlink{structcrpropa_1_1SophiaEventOutput}{SophiaEventOutput}} \{}
\DoxyCodeLine{16         \textcolor{keywordtype}{int} nParticles;}
\DoxyCodeLine{17         std::vector<double> energy;}
\DoxyCodeLine{18         std::vector<int> id;}
\DoxyCodeLine{19 \};}
\DoxyCodeLine{20 }
\DoxyCodeLine{25 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1PhotoPionProduction}{PhotoPionProduction}}: \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1Module}{Module}} \{}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{protected}:}
\DoxyCodeLine{28         \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<PhotonField>}} photonField;}
\DoxyCodeLine{29         std::vector<double> tabLorentz; }
\DoxyCodeLine{30         std::vector<double> tabRedshifts;  }
\DoxyCodeLine{31         std::vector<double> tabProtonRate; }
\DoxyCodeLine{32         std::vector<double> tabNeutronRate; }
\DoxyCodeLine{33         \textcolor{keywordtype}{double} limit; }
\DoxyCodeLine{34         \textcolor{keywordtype}{bool} havePhotons;}
\DoxyCodeLine{35         \textcolor{keywordtype}{bool} haveNeutrinos;}
\DoxyCodeLine{36         \textcolor{keywordtype}{bool} haveElectrons;}
\DoxyCodeLine{37         \textcolor{keywordtype}{bool} haveAntiNucleons;}
\DoxyCodeLine{38         \textcolor{keywordtype}{bool} haveRedshiftDependence;}
\DoxyCodeLine{39 }
\DoxyCodeLine{40         \textcolor{comment}{// called by: sampleEps}}
\DoxyCodeLine{41         \textcolor{comment}{// -\/ input: s [GeV\string^2]}}
\DoxyCodeLine{42         \textcolor{comment}{// -\/ output: (s-\/p\string^2) * sigma\_(nucleon/gamma) [GeV\string^2 * mubarn]}}
\DoxyCodeLine{43         \textcolor{keywordtype}{double} functs(\textcolor{keywordtype}{double} s, \textcolor{keywordtype}{bool} onProton) \textcolor{keyword}{const};}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{comment}{// called by: sampleEps, gaussInt}}
\DoxyCodeLine{46         \textcolor{comment}{// -\/ input: photon energy eps [eV], Ein [GeV]}}
\DoxyCodeLine{47         \textcolor{comment}{// -\/ output: probability to encounter photon of energy eps}}
\DoxyCodeLine{48         \textcolor{keywordtype}{double} probEps(\textcolor{keywordtype}{double} eps, \textcolor{keywordtype}{bool} onProton, \textcolor{keywordtype}{double} Ein, \textcolor{keywordtype}{double} z) \textcolor{keyword}{const};}
\DoxyCodeLine{49 }
\DoxyCodeLine{55         \textcolor{keywordtype}{double} epsMinInteraction(\textcolor{keywordtype}{bool} onProton, \textcolor{keywordtype}{double} Ein) \textcolor{keyword}{const};}
\DoxyCodeLine{56 }
\DoxyCodeLine{62         \textcolor{keywordtype}{double} momentum(\textcolor{keywordtype}{bool} onProton, \textcolor{keywordtype}{double} Ein) \textcolor{keyword}{const};}
\DoxyCodeLine{63         }
\DoxyCodeLine{64         \textcolor{comment}{// called by: functs}}
\DoxyCodeLine{65         \textcolor{comment}{// -\/ input: photon energy [eV]}}
\DoxyCodeLine{66         \textcolor{comment}{// -\/ output: crossection of nucleon-\/photon-\/interaction [mubarn]}}
\DoxyCodeLine{67         \textcolor{keywordtype}{double} crossection(\textcolor{keywordtype}{double} eps, \textcolor{keywordtype}{bool} onProton) \textcolor{keyword}{const};}
\DoxyCodeLine{68 }
\DoxyCodeLine{69         \textcolor{comment}{// called by: crossection}}
\DoxyCodeLine{70         \textcolor{comment}{// -\/ input: photon energy [eV], threshold [eV], max [eV], unknown [no unit]}}
\DoxyCodeLine{71         \textcolor{comment}{// -\/ output: unknown [no unit]}}
\DoxyCodeLine{72         \textcolor{keywordtype}{double} Pl(\textcolor{keywordtype}{double} eps, \textcolor{keywordtype}{double} xth, \textcolor{keywordtype}{double} xMax, \textcolor{keywordtype}{double} alpha) \textcolor{keyword}{const};}
\DoxyCodeLine{73 }
\DoxyCodeLine{74         \textcolor{comment}{// called by: crossection}}
\DoxyCodeLine{75         \textcolor{comment}{// -\/ input: photon energy [eV], threshold [eV], unknown [eV]}}
\DoxyCodeLine{76         \textcolor{comment}{// -\/ output: unknown [no unit]}}
\DoxyCodeLine{77         \textcolor{keywordtype}{double} Ef(\textcolor{keywordtype}{double} eps, \textcolor{keywordtype}{double} epsTh, \textcolor{keywordtype}{double} w) \textcolor{keyword}{const};}
\DoxyCodeLine{78 }
\DoxyCodeLine{79         \textcolor{comment}{// called by: crossection}}
\DoxyCodeLine{80         \textcolor{comment}{// -\/ input: cross section [Âµbarn], width [GeV], mass [GeV/c\string^2], rest frame photon energy [GeV]}}
\DoxyCodeLine{81         \textcolor{comment}{// -\/ output: Breit-\/Wigner crossection of a resonance of width Gamma}}
\DoxyCodeLine{82         \textcolor{keywordtype}{double} breitwigner(\textcolor{keywordtype}{double} sigma0, \textcolor{keywordtype}{double} gamma, \textcolor{keywordtype}{double} DMM, \textcolor{keywordtype}{double} epsPrime, \textcolor{keywordtype}{bool} onProton) \textcolor{keyword}{const};}
\DoxyCodeLine{83 }
\DoxyCodeLine{84         \textcolor{comment}{// called by: probEps, crossection, breitwigner, functs}}
\DoxyCodeLine{85         \textcolor{comment}{// -\/ input: is proton [bool]}}
\DoxyCodeLine{86         \textcolor{comment}{// -\/ output: mass [Gev/c\string^2]}}
\DoxyCodeLine{87         \textcolor{keywordtype}{double} mass(\textcolor{keywordtype}{bool} onProton) \textcolor{keyword}{const};}
\DoxyCodeLine{88 }
\DoxyCodeLine{89         \textcolor{comment}{// -\/ output: [GeV\string^2] head-\/on collision }}
\DoxyCodeLine{90         \textcolor{keywordtype}{double} sMin() \textcolor{keyword}{const};}
\DoxyCodeLine{91 }
\DoxyCodeLine{92         \textcolor{keywordtype}{bool} sampleLog = \textcolor{keyword}{true};}
\DoxyCodeLine{93         \textcolor{keywordtype}{double} correctionFactor = 1.6; \textcolor{comment}{// increeses the maximum of the propability function}}
\DoxyCodeLine{94         }
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{keyword}{public}:}
\DoxyCodeLine{97         \mbox{\hyperlink{classcrpropa_1_1PhotoPionProduction}{PhotoPionProduction}}(}
\DoxyCodeLine{98                 \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<PhotonField>}} photonField,}
\DoxyCodeLine{99                 \textcolor{keywordtype}{bool} photons = \textcolor{keyword}{false},}
\DoxyCodeLine{100                 \textcolor{keywordtype}{bool} neutrinos = \textcolor{keyword}{false},}
\DoxyCodeLine{101                 \textcolor{keywordtype}{bool} electrons = \textcolor{keyword}{false},}
\DoxyCodeLine{102                 \textcolor{keywordtype}{bool} antiNucleons = \textcolor{keyword}{false},}
\DoxyCodeLine{103                 \textcolor{keywordtype}{double} limit = 0.1,}
\DoxyCodeLine{104                 \textcolor{keywordtype}{bool} haveRedshiftDependence = \textcolor{keyword}{false});}
\DoxyCodeLine{105         \textcolor{keywordtype}{void} setPhotonField(\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<PhotonField>}} photonField);}
\DoxyCodeLine{106         \textcolor{keywordtype}{void} setHavePhotons(\textcolor{keywordtype}{bool} b);}
\DoxyCodeLine{107         \textcolor{keywordtype}{void} setHaveNeutrinos(\textcolor{keywordtype}{bool} b);}
\DoxyCodeLine{108         \textcolor{keywordtype}{void} setHaveElectrons(\textcolor{keywordtype}{bool} b);}
\DoxyCodeLine{109         \textcolor{keywordtype}{void} setHaveAntiNucleons(\textcolor{keywordtype}{bool} b);}
\DoxyCodeLine{110         \textcolor{keywordtype}{void} setHaveRedshiftDependence(\textcolor{keywordtype}{bool} b);}
\DoxyCodeLine{111         \textcolor{keywordtype}{void} setLimit(\textcolor{keywordtype}{double} limit);}
\DoxyCodeLine{112         \textcolor{keywordtype}{void} initRate(std::string filename);}
\DoxyCodeLine{113         \textcolor{keywordtype}{double} nucleonMFP(\textcolor{keywordtype}{double} gamma, \textcolor{keywordtype}{double} z, \textcolor{keywordtype}{bool} onProton) \textcolor{keyword}{const};}
\DoxyCodeLine{114         \textcolor{keywordtype}{double} nucleiModification(\textcolor{keywordtype}{int} A, \textcolor{keywordtype}{int} X) \textcolor{keyword}{const};}
\DoxyCodeLine{115         \textcolor{keywordtype}{void} process(\mbox{\hyperlink{classcrpropa_1_1Candidate}{Candidate}} *candidate) \textcolor{keyword}{const};}
\DoxyCodeLine{116         \textcolor{keywordtype}{void} performInteraction(\mbox{\hyperlink{classcrpropa_1_1Candidate}{Candidate}} *candidate, \textcolor{keywordtype}{bool} onProton) \textcolor{keyword}{const};}
\DoxyCodeLine{117 }
\DoxyCodeLine{125         \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1PhotoPionProduction_a186df9faa7b56d876ec9faac635ab114}{lossLength}}(\textcolor{keywordtype}{int} \textcolor{keywordtype}{id}, \textcolor{keywordtype}{double} gamma, \textcolor{keywordtype}{double} z = 0);}
\DoxyCodeLine{126 }
\DoxyCodeLine{136         \mbox{\hyperlink{structcrpropa_1_1SophiaEventOutput}{SophiaEventOutput}} \mbox{\hyperlink{classcrpropa_1_1PhotoPionProduction_a1f12f12580e9363d1dcb13e0034773d0}{sophiaEvent}}(\textcolor{keywordtype}{bool} onProton, \textcolor{keywordtype}{double} Ein, \textcolor{keywordtype}{double} eps) \textcolor{keyword}{const};}
\DoxyCodeLine{137 }
\DoxyCodeLine{144         \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1PhotoPionProduction_a5dabf744b0e83ea7de0a26a047ab0cbe}{sampleEps}}(\textcolor{keywordtype}{bool} onProton, \textcolor{keywordtype}{double} E, \textcolor{keywordtype}{double} z) \textcolor{keyword}{const};}
\DoxyCodeLine{145         }
\DoxyCodeLine{154         \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1PhotoPionProduction_ab8398a04a64e7c7152d5453bff059387}{probEpsMax}}(\textcolor{keywordtype}{bool} onProton, \textcolor{keywordtype}{double} Ein, \textcolor{keywordtype}{double} z, \textcolor{keywordtype}{double} epsMin, \textcolor{keywordtype}{double} epsMax) \textcolor{keyword}{const};}
\DoxyCodeLine{155         }
\DoxyCodeLine{156         \textcolor{comment}{// using log or lin spacing of photons in the range between epsMin and}}
\DoxyCodeLine{157         \textcolor{comment}{// epsMax for computing the maximum probability of photons in field}}
\DoxyCodeLine{158         \textcolor{keywordtype}{void} setSampleLog(\textcolor{keywordtype}{bool} log);}
\DoxyCodeLine{159 }
\DoxyCodeLine{160         \textcolor{comment}{// given the discrete steps to compute the maximum interaction probability pEpsMax }}
\DoxyCodeLine{161         \textcolor{comment}{// of photons in field, the real pEpsMax may lie between the descrete tested photon energies.}}
\DoxyCodeLine{162         \textcolor{comment}{// A correction factor can be set to increase pEpsMax by that factor}}
\DoxyCodeLine{163         \textcolor{keywordtype}{void} setCorrectionFactor(\textcolor{keywordtype}{double} factor);}
\DoxyCodeLine{164 }
\DoxyCodeLine{166         \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<PhotonField>}} \mbox{\hyperlink{classcrpropa_1_1PhotoPionProduction_a9c22d1999ae17919e778fd151aa00bb8}{getPhotonField}}() \textcolor{keyword}{const};}
\DoxyCodeLine{167         \textcolor{keywordtype}{bool} getHavePhotons() \textcolor{keyword}{const};}
\DoxyCodeLine{168         \textcolor{keywordtype}{bool} getHaveNeutrinos() \textcolor{keyword}{const};}
\DoxyCodeLine{169         \textcolor{keywordtype}{bool} getHaveElectrons() \textcolor{keyword}{const};}
\DoxyCodeLine{170         \textcolor{keywordtype}{bool} getHaveAntiNucleons() \textcolor{keyword}{const};}
\DoxyCodeLine{171         \textcolor{keywordtype}{bool} getHaveRedshiftDependence() \textcolor{keyword}{const};}
\DoxyCodeLine{172         \textcolor{keywordtype}{double} getLimit() \textcolor{keyword}{const};}
\DoxyCodeLine{173         \textcolor{keywordtype}{bool} getSampleLog() \textcolor{keyword}{const};}
\DoxyCodeLine{174         \textcolor{keywordtype}{double} getCorrectionFactor() \textcolor{keyword}{const};}
\DoxyCodeLine{175 \};}
\DoxyCodeLine{178 \} \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_PHOTOPIONPRODUCTION\_H}}

\end{DoxyCode}
