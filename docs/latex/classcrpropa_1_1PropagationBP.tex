\hypertarget{classcrpropa_1_1PropagationBP}{}\doxysection{Propagation\+BP Class Reference}
\label{classcrpropa_1_1PropagationBP}\index{PropagationBP@{PropagationBP}}


Propagation through magnetic fields using the Boris method.  


Inheritance diagram for Propagation\+BP\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classcrpropa_1_1PropagationBP}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcrpropa_1_1PropagationBP_a1dae10c65075c130de52a7b6f5b5c542}{Propagation\+BP}} (\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}} $>$ field=NULL, double fixed\+Step=1. $\ast$kpc)
\item 
\mbox{\hyperlink{classcrpropa_1_1PropagationBP_a1e995feca2699ca6bd87037fae415752}{Propagation\+BP}} (\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}} $>$ field, double tolerance, double min\+Step, double max\+Step)
\item 
void \mbox{\hyperlink{classcrpropa_1_1PropagationBP_ab59d2de78ed0589c122df3d6c0478b41}{process}} (\mbox{\hyperlink{classcrpropa_1_1Candidate}{Candidate}} $\ast$candidate) const
\item 
\mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a4571f7cbb9927197bb405306c789fcab}{dY}} (\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} pos, \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} dir, double step, double z, double q, double m) const
\item 
double \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a114dc0d80ebe1c9a993011c262db2dec}{error\+Estimation}} (const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} x1, const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} x2, double step) const
\item 
\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a96c7f39fd36d2893d472fc781f1cbed3}{get\+Field\+At\+Position}} (\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} pos, double z) const
\item 
void \mbox{\hyperlink{classcrpropa_1_1PropagationBP_aed78cae860289e629f395eb8613a8232}{try\+Step}} (const \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&y, \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&out, \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&error, double h, \mbox{\hyperlink{classcrpropa_1_1ParticleState}{Particle\+State}} \&p, double z, double m, double q) const
\item 
void \mbox{\hyperlink{classcrpropa_1_1PropagationBP_ad9d809e7ecc2fc687d96e64cb86220ef}{set\+Field}} (\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}} $>$ field)
\item 
void \mbox{\hyperlink{classcrpropa_1_1PropagationBP_ab775e7293ddd12cd11332ce73d1cdec3}{set\+Tolerance}} (double tolerance)
\item 
void \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a0b1342c4f83f19cc5f39a3e5bd76d13e}{set\+Minimum\+Step}} (double min\+Step)
\item 
void \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a11a631bd22325f3106b56f03fb7375c4}{set\+Maximum\+Step}} (double max\+Step)
\item 
\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}} $>$ \mbox{\hyperlink{classcrpropa_1_1PropagationBP_aa48029387370c13d184bff20ea2421da}{get\+Field}} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a1651d37454cc7d2973a5816fb86fb904}\label{classcrpropa_1_1PropagationBP_a1651d37454cc7d2973a5816fb86fb904}} 
double {\bfseries get\+Tolerance} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_aa21f57f6f16a13774ce009e63005ab09}\label{classcrpropa_1_1PropagationBP_aa21f57f6f16a13774ce009e63005ab09}} 
double {\bfseries get\+Minimum\+Step} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a35970f0d50e796aedceffa148be99c2e}\label{classcrpropa_1_1PropagationBP_a35970f0d50e796aedceffa148be99c2e}} 
double {\bfseries get\+Maximum\+Step} () const
\item 
std\+::string \mbox{\hyperlink{classcrpropa_1_1PropagationBP_aea425314aebc36d0f6bf7671705158da}{get\+Description}} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Module_a3406b56004afdbe7a1815a541d40de99}\label{classcrpropa_1_1Module_a3406b56004afdbe7a1815a541d40de99}} 
void {\bfseries set\+Description} (const std\+::string \&description)
\item 
\mbox{\Hypertarget{classcrpropa_1_1Module_a9f2321c49330b61a52ce55c2015e4c49}\label{classcrpropa_1_1Module_a9f2321c49330b61a52ce55c2015e4c49}} 
void {\bfseries process} (\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1Candidate}{Candidate}} $>$ candidate) const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Referenced_a6ef7442f4d857baf3d3a39fdeec4aadd}\label{classcrpropa_1_1Referenced_a6ef7442f4d857baf3d3a39fdeec4aadd}} 
size\+\_\+t {\bfseries add\+Reference} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Referenced_ab9f5dbbba1431274016b3d74426953f2}\label{classcrpropa_1_1Referenced_ab9f5dbbba1431274016b3d74426953f2}} 
size\+\_\+t {\bfseries remove\+Reference} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Referenced_adab41cca5664d4668930f93beefa39b5}\label{classcrpropa_1_1Referenced_adab41cca5664d4668930f93beefa39b5}} 
int {\bfseries remove\+Reference\+No\+Delete} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Referenced_a74487fc4399bfa67c7251dae5d4247cd}\label{classcrpropa_1_1Referenced_a74487fc4399bfa67c7251dae5d4247cd}} 
size\+\_\+t {\bfseries get\+Reference\+Count} () const
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Propagation through magnetic fields using the Boris method. 

This module solves the equations of motion of a relativistic charged particle when propagating through a magnetic field.~\newline
It uses the Boris push integration method.~\newline
It can be used with a fixed step size or an adaptive version which supports the step size control. The step size control tries to keep the relative error close to, but smaller than the designated tolerance. Additionally a minimum and maximum size for the steps can be set. For neutral particles a rectilinear propagation is applied and a next step of the maximum step size proposed. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a1dae10c65075c130de52a7b6f5b5c542}\label{classcrpropa_1_1PropagationBP_a1dae10c65075c130de52a7b6f5b5c542}} 
\index{PropagationBP@{PropagationBP}!PropagationBP@{PropagationBP}}
\index{PropagationBP@{PropagationBP}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{PropagationBP()}{PropagationBP()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1PropagationBP}{Propagation\+BP}} (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}} $>$}]{field = {\ttfamily NULL},  }\item[{double}]{fixed\+Step = {\ttfamily 1.~$\ast$kpc} }\end{DoxyParamCaption})}

maximum step size of the propagation Default constructor for the Boris push. It is constructed with a fixed step size. 
\begin{DoxyParams}{Parameters}
{\em field} & \\
\hline
{\em fixed\+Step} & \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a1e995feca2699ca6bd87037fae415752}\label{classcrpropa_1_1PropagationBP_a1e995feca2699ca6bd87037fae415752}} 
\index{PropagationBP@{PropagationBP}!PropagationBP@{PropagationBP}}
\index{PropagationBP@{PropagationBP}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{PropagationBP()}{PropagationBP()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1PropagationBP}{Propagation\+BP}} (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}} $>$}]{field,  }\item[{double}]{tolerance,  }\item[{double}]{min\+Step,  }\item[{double}]{max\+Step }\end{DoxyParamCaption})}

Constructor for the adaptive Boris push. 
\begin{DoxyParams}{Parameters}
{\em field} & \\
\hline
{\em tolerance} & tolerance is criterion for step adjustment. Step adjustment takes place only if min\+Step \texorpdfstring{$<$}{<} max\+Step \\
\hline
{\em min\+Step} & min\+Step/c\+\_\+light is the minimum integration time step \\
\hline
{\em max\+Step} & max\+Step/c\+\_\+light is the maximum integration time step. \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a4571f7cbb9927197bb405306c789fcab}\label{classcrpropa_1_1PropagationBP_a4571f7cbb9927197bb405306c789fcab}} 
\index{PropagationBP@{PropagationBP}!dY@{dY}}
\index{dY@{dY}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{dY()}{dY()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} dY (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}}]{pos,  }\item[{\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}}]{dir,  }\item[{double}]{step,  }\item[{double}]{z,  }\item[{double}]{q,  }\item[{double}]{m }\end{DoxyParamCaption}) const}

Calculates the new position and direction of the particle based on the solution of the Lorentz force 
\begin{DoxyParams}{Parameters}
{\em pos} & current position of the candidate \\
\hline
{\em dir} & current direction of the candidate \\
\hline
{\em step} & current step size of the candidate \\
\hline
{\em z} & current redshift is needed to calculate the magnetic field \\
\hline
{\em q} & current charge of the candidate \\
\hline
{\em m} & current mass of the candidate \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
return the new calculated position and direction of the candidate 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a114dc0d80ebe1c9a993011c262db2dec}\label{classcrpropa_1_1PropagationBP_a114dc0d80ebe1c9a993011c262db2dec}} 
\index{PropagationBP@{PropagationBP}!errorEstimation@{errorEstimation}}
\index{errorEstimation@{errorEstimation}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{errorEstimation()}{errorEstimation()}}
{\footnotesize\ttfamily double error\+Estimation (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}}]{x1,  }\item[{const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}}]{x2,  }\item[{double}]{step }\end{DoxyParamCaption}) const}

comparison of the position after one step with the position after two steps with step/2. 
\begin{DoxyParams}{Parameters}
{\em x1} & position after one step of size step \\
\hline
{\em x2} & position after two steps of size step/2 \\
\hline
{\em step} & current step size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
measurement of the error of the step 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_aea425314aebc36d0f6bf7671705158da}\label{classcrpropa_1_1PropagationBP_aea425314aebc36d0f6bf7671705158da}} 
\index{PropagationBP@{PropagationBP}!getDescription@{getDescription}}
\index{getDescription@{getDescription}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{getDescription()}{getDescription()}}
{\footnotesize\ttfamily std\+::string get\+Description (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{classcrpropa_1_1Module}{Module}}.

\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_aa48029387370c13d184bff20ea2421da}\label{classcrpropa_1_1PropagationBP_aa48029387370c13d184bff20ea2421da}} 
\index{PropagationBP@{PropagationBP}!getField@{getField}}
\index{getField@{getField}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{getField()}{getField()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}} $>$ get\+Field (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Get functions for the parameters of the class \mbox{\hyperlink{classcrpropa_1_1PropagationBP}{Propagation\+BP}}, similar to the set functions \mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a96c7f39fd36d2893d472fc781f1cbed3}\label{classcrpropa_1_1PropagationBP_a96c7f39fd36d2893d472fc781f1cbed3}} 
\index{PropagationBP@{PropagationBP}!getFieldAtPosition@{getFieldAtPosition}}
\index{getFieldAtPosition@{getFieldAtPosition}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{getFieldAtPosition()}{getFieldAtPosition()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} get\+Field\+At\+Position (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}}]{pos,  }\item[{double}]{z }\end{DoxyParamCaption}) const}

Get magnetic field vector at current candidate position 
\begin{DoxyParams}{Parameters}
{\em pos} & current position of the candidate \\
\hline
{\em z} & current redshift is needed to calculate the magnetic field \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
magnetic field vector at the position pos 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_ab59d2de78ed0589c122df3d6c0478b41}\label{classcrpropa_1_1PropagationBP_ab59d2de78ed0589c122df3d6c0478b41}} 
\index{PropagationBP@{PropagationBP}!process@{process}}
\index{process@{process}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{process()}{process()}}
{\footnotesize\ttfamily void process (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcrpropa_1_1Candidate}{Candidate}} $\ast$}]{candidate }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}

Propagates the particle. Is called once per iteration. 
\begin{DoxyParams}{Parameters}
{\em candidate} & The \mbox{\hyperlink{classcrpropa_1_1Candidate}{Candidate}} is a passive object, that holds the information about the state of the cosmic ray and the simulation itself. \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classcrpropa_1_1Module}{Module}}.

\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_ad9d809e7ecc2fc687d96e64cb86220ef}\label{classcrpropa_1_1PropagationBP_ad9d809e7ecc2fc687d96e64cb86220ef}} 
\index{PropagationBP@{PropagationBP}!setField@{setField}}
\index{setField@{setField}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{setField()}{setField()}}
{\footnotesize\ttfamily void set\+Field (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}} $>$}]{field }\end{DoxyParamCaption})}

Set functions for the parameters of the class \mbox{\hyperlink{classcrpropa_1_1PropagationBP}{Propagation\+BP}} Set a specific magnetic field 
\begin{DoxyParams}{Parameters}
{\em field} & specific magnetic field \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a11a631bd22325f3106b56f03fb7375c4}\label{classcrpropa_1_1PropagationBP_a11a631bd22325f3106b56f03fb7375c4}} 
\index{PropagationBP@{PropagationBP}!setMaximumStep@{setMaximumStep}}
\index{setMaximumStep@{setMaximumStep}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{setMaximumStep()}{setMaximumStep()}}
{\footnotesize\ttfamily void set\+Maximum\+Step (\begin{DoxyParamCaption}\item[{double}]{max\+Step }\end{DoxyParamCaption})}

Set the maximum step for the Boris push 
\begin{DoxyParams}{Parameters}
{\em max\+Step} & max\+Step/c\+\_\+light is the maximum integration time step \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_a0b1342c4f83f19cc5f39a3e5bd76d13e}\label{classcrpropa_1_1PropagationBP_a0b1342c4f83f19cc5f39a3e5bd76d13e}} 
\index{PropagationBP@{PropagationBP}!setMinimumStep@{setMinimumStep}}
\index{setMinimumStep@{setMinimumStep}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{setMinimumStep()}{setMinimumStep()}}
{\footnotesize\ttfamily void set\+Minimum\+Step (\begin{DoxyParamCaption}\item[{double}]{min\+Step }\end{DoxyParamCaption})}

Set the minimum step for the Boris push 
\begin{DoxyParams}{Parameters}
{\em min\+Step} & min\+Step/c\+\_\+light is the minimum integration time step \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_ab775e7293ddd12cd11332ce73d1cdec3}\label{classcrpropa_1_1PropagationBP_ab775e7293ddd12cd11332ce73d1cdec3}} 
\index{PropagationBP@{PropagationBP}!setTolerance@{setTolerance}}
\index{setTolerance@{setTolerance}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{setTolerance()}{setTolerance()}}
{\footnotesize\ttfamily void set\+Tolerance (\begin{DoxyParamCaption}\item[{double}]{tolerance }\end{DoxyParamCaption})}

Set a specific tolerance for the step size adaption 
\begin{DoxyParams}{Parameters}
{\em tolerance} & tolerance is criterion for step adjustment. Step adjustment takes place only if min\+Step \texorpdfstring{$<$}{<} max\+Step. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcrpropa_1_1PropagationBP_aed78cae860289e629f395eb8613a8232}\label{classcrpropa_1_1PropagationBP_aed78cae860289e629f395eb8613a8232}} 
\index{PropagationBP@{PropagationBP}!tryStep@{tryStep}}
\index{tryStep@{tryStep}!PropagationBP@{PropagationBP}}
\doxysubsubsection{\texorpdfstring{tryStep()}{tryStep()}}
{\footnotesize\ttfamily void try\+Step (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&}]{y,  }\item[{\mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&}]{out,  }\item[{\mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&}]{error,  }\item[{double}]{h,  }\item[{\mbox{\hyperlink{classcrpropa_1_1ParticleState}{Particle\+State}} \&}]{p,  }\item[{double}]{z,  }\item[{double}]{m,  }\item[{double}]{q }\end{DoxyParamCaption}) const}

Adapt step size if required and calculates the new position and direction of the particle with the usage of the function dY 
\begin{DoxyParams}{Parameters}
{\em y} & current position and direction of candidate \\
\hline
{\em out} & position and direction of candidate after the step \\
\hline
{\em error} & error for the current step \\
\hline
{\em h} & current step size \\
\hline
{\em p} & current particle state \\
\hline
{\em z} & current red shift \\
\hline
{\em m} & current mass of the candidate \\
\hline
{\em q} & current charge of the candidate \\
\hline
\end{DoxyParams}
