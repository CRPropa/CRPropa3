\hypertarget{TurbulentField_8h_source}{}\doxysection{Turbulent\+Field.\+h}
\label{TurbulentField_8h_source}\index{TurbulentField.h@{TurbulentField.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_TURBULENTFIELD\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_TURBULENTFIELD\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}crpropa/magneticField/MagneticField.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{17 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1TurbulenceSpectrum}{TurbulenceSpectrum}} : \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1Referenced}{Referenced}} \{}
\DoxyCodeLine{18   \textcolor{keyword}{private}:}
\DoxyCodeLine{19         \textcolor{keyword}{const} \textcolor{keywordtype}{double} Brms; }
\DoxyCodeLine{20         \textcolor{keyword}{const} \textcolor{keywordtype}{double} sIndex; }
\DoxyCodeLine{25         \textcolor{keyword}{const} \textcolor{keywordtype}{double} qIndex; }
\DoxyCodeLine{27         \textcolor{keyword}{const} \textcolor{keywordtype}{double} lBendover;  }
\DoxyCodeLine{28         \textcolor{keyword}{const} \textcolor{keywordtype}{double} lMin, lMax; }
\DoxyCodeLine{30   \textcolor{keyword}{protected}:}
\DoxyCodeLine{34         \textcolor{keywordtype}{double} spectrumNormalization()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{35                 \textcolor{keywordflow}{return} std::tgamma((sIndex + qIndex) / 2.0) /}
\DoxyCodeLine{36                        (2.0 * std::tgamma((sIndex -\/ 1) / 2.0) *}
\DoxyCodeLine{37                         std::tgamma((qIndex + 1) / 2.0));}
\DoxyCodeLine{38         \}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40   \textcolor{keyword}{public}:}
\DoxyCodeLine{51         \mbox{\hyperlink{classcrpropa_1_1TurbulenceSpectrum_a5722e694e4e34ba08d4578c8942e0b0f}{TurbulenceSpectrum}}(\textcolor{keywordtype}{double} Brms, \textcolor{keywordtype}{double} lMin, \textcolor{keywordtype}{double} lMax,}
\DoxyCodeLine{52                            \textcolor{keywordtype}{double} lBendover = 1, \textcolor{keywordtype}{double} sIndex = (5. / 3.),}
\DoxyCodeLine{53                            \textcolor{keywordtype}{double} qIndex = 4)}
\DoxyCodeLine{54             : Brms(Brms), lMin(lMin), lMax(lMax), lBendover(lBendover),}
\DoxyCodeLine{55               sIndex(sIndex), qIndex(qIndex) \{}
\DoxyCodeLine{56                 \textcolor{keywordflow}{if} (lMin > lMax) \{}
\DoxyCodeLine{57                         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}TurbulenceSpectrum: lMin > lMax"{}});}
\DoxyCodeLine{58                 \}}
\DoxyCodeLine{59                 \textcolor{keywordflow}{if} (lMin <= 0) \{}
\DoxyCodeLine{60                         \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}TurbulenceSpectrum: lMin <= 0"{}});}
\DoxyCodeLine{61                 \}}
\DoxyCodeLine{62         \}}
\DoxyCodeLine{63 }
\DoxyCodeLine{64         \mbox{\hyperlink{classcrpropa_1_1TurbulenceSpectrum}{\string~TurbulenceSpectrum}}() \{\}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66         \textcolor{keywordtype}{double} getBrms()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} Brms; \}}
\DoxyCodeLine{67         \textcolor{keywordtype}{double} getLmin()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} lMin; \}}
\DoxyCodeLine{68         \textcolor{keywordtype}{double} getLmax()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} lMax; \}}
\DoxyCodeLine{69         \textcolor{keywordtype}{double} getLbendover()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} lBendover; \}}
\DoxyCodeLine{70         \textcolor{keywordtype}{double} getSindex()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} sIndex; \}}
\DoxyCodeLine{71         \textcolor{keywordtype}{double} getQindex()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} qIndex; \}}
\DoxyCodeLine{72         }
\DoxyCodeLine{77         \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1TurbulenceSpectrum_a9de25e7b8bba27f51cdab4fca26e37ea}{energySpectrum}}(\textcolor{keywordtype}{double} kHat)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{78                 \textcolor{keywordflow}{return} std::pow(kHat, qIndex) /}
\DoxyCodeLine{79                                        std::pow(1.0 + kHat * kHat,}
\DoxyCodeLine{80                                         (sIndex + qIndex) / 2.0 + 1.0);}
\DoxyCodeLine{81         \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{90         \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} getCorrelationLength()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{91                 \textcolor{keywordflow}{return} 4 * M\_PI / ((sIndex + 2.0) * sIndex) * spectrumNormalization() *}
\DoxyCodeLine{92                        lBendover;}
\DoxyCodeLine{93         \}}
\DoxyCodeLine{94 \};}
\DoxyCodeLine{95 }
\DoxyCodeLine{103 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1TurbulentField}{TurbulentField}} : \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1MagneticField}{MagneticField}} \{}
\DoxyCodeLine{104   \textcolor{keyword}{protected}:}
\DoxyCodeLine{105         \textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1TurbulenceSpectrum}{TurbulenceSpectrum}} \&spectrum;}
\DoxyCodeLine{106 }
\DoxyCodeLine{107   \textcolor{keyword}{public}:}
\DoxyCodeLine{108         \mbox{\hyperlink{classcrpropa_1_1TurbulentField}{TurbulentField}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1TurbulenceSpectrum}{TurbulenceSpectrum}} \&spectrum) : spectrum(spectrum) \{\}}
\DoxyCodeLine{109         \textcolor{keyword}{virtual} \mbox{\hyperlink{classcrpropa_1_1TurbulentField}{\string~TurbulentField}}() \{\}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111         \textcolor{keywordtype}{double} getBrms()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} spectrum.getBrms(); \}}
\DoxyCodeLine{112         \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} getCorrelationLength()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{113                 \textcolor{keywordflow}{return} spectrum.getCorrelationLength();}
\DoxyCodeLine{114         \}}
\DoxyCodeLine{115 \};}
\DoxyCodeLine{116 }
\DoxyCodeLine{119 \} \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_TURBULENTFIELD\_H}}

\end{DoxyCode}
