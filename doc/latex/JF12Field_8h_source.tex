\hypertarget{JF12Field_8h_source}{}\doxysection{JF12\+Field.\+h}
\label{JF12Field_8h_source}\index{JF12Field.h@{JF12Field.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_JF12FIELD\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_JF12FIELD\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}crpropa/magneticField/MagneticField.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}crpropa/Grid.h"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}kiss/logger.h"{}}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{9 }
\DoxyCodeLine{31 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12Field}}: \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1MagneticField}{MagneticField}} \{}
\DoxyCodeLine{32 \textcolor{keyword}{protected}:}
\DoxyCodeLine{33         \textcolor{keywordtype}{bool} useRegularField;}
\DoxyCodeLine{34         \textcolor{keywordtype}{bool} useStriatedField;}
\DoxyCodeLine{35         \textcolor{keywordtype}{bool} useTurbulentField;}
\DoxyCodeLine{36         \textcolor{keywordtype}{bool} useDiskField;}
\DoxyCodeLine{37         \textcolor{keywordtype}{bool} useToroidalHaloField;}
\DoxyCodeLine{38         \textcolor{keywordtype}{bool} useXField;}
\DoxyCodeLine{39 }
\DoxyCodeLine{40         \textcolor{comment}{// disk spiral arms}}
\DoxyCodeLine{41         \textcolor{keywordtype}{double} rArms[8];       \textcolor{comment}{// radii where each arm crosses the negative x-\/axis}}
\DoxyCodeLine{42         \textcolor{keywordtype}{double} pitch;          \textcolor{comment}{// pitch angle}}
\DoxyCodeLine{43         \textcolor{keywordtype}{double} sinPitch, cosPitch, tanPitch, cotPitch, tan90MinusPitch;}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{comment}{// Regular field -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{46         \textcolor{comment}{// disk}}
\DoxyCodeLine{47         \textcolor{keywordtype}{double} bDisk[11];      \textcolor{comment}{// field strengths of the 8 arms at r=5 kpc; additional entries added for periodic closure in JF12FieldSolenoidal}}
\DoxyCodeLine{48         \textcolor{keywordtype}{double} bRing;          \textcolor{comment}{// ring field strength 3<r<5 kpc}}
\DoxyCodeLine{49         \textcolor{keywordtype}{double} hDisk, wDisk;   \textcolor{comment}{// disk/halo transistion and width}}
\DoxyCodeLine{50         \textcolor{comment}{// toroidal halo}}
\DoxyCodeLine{51         \textcolor{keywordtype}{double} bNorth, bSouth; \textcolor{comment}{// northern, southern halo field strength}}
\DoxyCodeLine{52         \textcolor{keywordtype}{double} rNorth, rSouth; \textcolor{comment}{// northern, southern transistion radius}}
\DoxyCodeLine{53         \textcolor{keywordtype}{double} wHalo, z0;      \textcolor{comment}{// transistion width and vertical scale height}}
\DoxyCodeLine{54         \textcolor{comment}{// poloidal halo}}
\DoxyCodeLine{55         \textcolor{keywordtype}{double} bX;             \textcolor{comment}{// field strength at origin}}
\DoxyCodeLine{56         \textcolor{keywordtype}{double} thetaX0;        \textcolor{comment}{// constant elevation angle at r > rXc, z = 0}}
\DoxyCodeLine{57         \textcolor{keywordtype}{double} sinThetaX0, cosThetaX0, tanThetaX0, cotThetaX0;}
\DoxyCodeLine{58         \textcolor{keywordtype}{double} rXc;            \textcolor{comment}{// radius of varying elevation angle region}}
\DoxyCodeLine{59         \textcolor{keywordtype}{double} rX;             \textcolor{comment}{// exponential scale height}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61         \textcolor{comment}{// Striated field -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{62         \textcolor{keywordtype}{double} sqrtbeta;       \textcolor{comment}{// relative strength of striated field}}
\DoxyCodeLine{63         \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<Grid1f>}} striatedGrid;}
\DoxyCodeLine{64 }
\DoxyCodeLine{65         \textcolor{comment}{// Turbulent field -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{66         \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<Grid3f>}} turbulentGrid;}
\DoxyCodeLine{67         \textcolor{comment}{// disk}}
\DoxyCodeLine{68         \textcolor{keywordtype}{double} bDiskTurb[8]; \textcolor{comment}{// field strengths in arms at r=5 kpc}}
\DoxyCodeLine{69         \textcolor{keywordtype}{double} bDiskTurb5;   \textcolor{comment}{// field strength at r<5kpc}}
\DoxyCodeLine{70         \textcolor{keywordtype}{double} zDiskTurb;        \textcolor{comment}{// Gaussian scale height of disk}}
\DoxyCodeLine{71         \textcolor{comment}{// halo}}
\DoxyCodeLine{72         \textcolor{keywordtype}{double} bHaloTurb; \textcolor{comment}{// halo field strength}}
\DoxyCodeLine{73         \textcolor{keywordtype}{double} rHaloTurb; \textcolor{comment}{// exponential scale length}}
\DoxyCodeLine{74         \textcolor{keywordtype}{double} zHaloTurb; \textcolor{comment}{// Gaussian scale height}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76 \textcolor{keyword}{public}:}
\DoxyCodeLine{77         \mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12Field}}();}
\DoxyCodeLine{78 }
\DoxyCodeLine{79         \textcolor{comment}{// Create and set a random realization for the striated field}}
\DoxyCodeLine{80         \textcolor{keywordtype}{void} randomStriated(\textcolor{keywordtype}{int} seed = 0);}
\DoxyCodeLine{81 }
\DoxyCodeLine{82 \textcolor{preprocessor}{\#ifdef CRPROPA\_HAVE\_FFTW3F}}
\DoxyCodeLine{83         \textcolor{comment}{// Create a random realization for the turbulent field}}
\DoxyCodeLine{84         \textcolor{keywordtype}{void} randomTurbulent(\textcolor{keywordtype}{int} seed = 0);}
\DoxyCodeLine{85 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{86 }
\DoxyCodeLine{91         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1JF12Field_a8cb275c1344647266e85a679d44abf24}{setStriatedGrid}}(\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<Grid1f>}} grid);}
\DoxyCodeLine{92 }
\DoxyCodeLine{97         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1JF12Field_abc09924adf731be01ce5e484e534e58d}{setTurbulentGrid}}(\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<Grid3f>}} grid);}
\DoxyCodeLine{98 }
\DoxyCodeLine{99         \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<Grid1f>}} getStriatedGrid();}
\DoxyCodeLine{100         \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<Grid3f>}} getTurbulentGrid();}
\DoxyCodeLine{101 }
\DoxyCodeLine{102         \textcolor{keywordtype}{void} setUseRegularField(\textcolor{keywordtype}{bool} use);}
\DoxyCodeLine{103         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} setUseStriatedField(\textcolor{keywordtype}{bool} use);}
\DoxyCodeLine{104         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} setUseTurbulentField(\textcolor{keywordtype}{bool} use);}
\DoxyCodeLine{105         \textcolor{keywordtype}{void} setUseDiskField(\textcolor{keywordtype}{bool} use);}
\DoxyCodeLine{106         \textcolor{keywordtype}{void} setUseToroidalHaloField(\textcolor{keywordtype}{bool} use);}
\DoxyCodeLine{107         \textcolor{keywordtype}{void} setUseXField(\textcolor{keywordtype}{bool} use);}
\DoxyCodeLine{108 }
\DoxyCodeLine{109         \textcolor{keywordtype}{bool} isUsingRegularField();}
\DoxyCodeLine{110         \textcolor{keywordtype}{bool} isUsingStriatedField();}
\DoxyCodeLine{111         \textcolor{keywordtype}{bool} isUsingTurbulentField();}
\DoxyCodeLine{112         \textcolor{keywordtype}{bool} isUsingDiskField();}
\DoxyCodeLine{113         \textcolor{keywordtype}{bool} isUsingToroidalHaloField();}
\DoxyCodeLine{114         \textcolor{keywordtype}{bool} isUsingXField();}
\DoxyCodeLine{115 }
\DoxyCodeLine{116         \textcolor{keywordtype}{double} logisticFunction(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& x, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& x0, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& w) \textcolor{keyword}{const};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118         \textcolor{comment}{// Regular field components}}
\DoxyCodeLine{119         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getRegularField(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}\& pos) \textcolor{keyword}{const};}
\DoxyCodeLine{120         \textcolor{keyword}{virtual} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getDiskField(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& z, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& phi, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& sinPhi, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& cosPhi) \textcolor{keyword}{const};}
\DoxyCodeLine{121         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getToroidalHaloField(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& z, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& sinPhi, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& cosPhi) \textcolor{keyword}{const};}
\DoxyCodeLine{122         \textcolor{keyword}{virtual} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getXField(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& z, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& sinPhi, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& cosPhi) \textcolor{keyword}{const};}
\DoxyCodeLine{123 }
\DoxyCodeLine{124         \textcolor{comment}{// Regular and striated field component}}
\DoxyCodeLine{125         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getStriatedField(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}\& pos) \textcolor{keyword}{const};}
\DoxyCodeLine{126 }
\DoxyCodeLine{127         \textcolor{comment}{// Brms of the turbulent field}}
\DoxyCodeLine{128         \textcolor{keywordtype}{double} getTurbulentStrength(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}\& pos) \textcolor{keyword}{const};}
\DoxyCodeLine{129 }
\DoxyCodeLine{130         \textcolor{comment}{// Turbulent field component}}
\DoxyCodeLine{131         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getTurbulentField(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}\& pos) \textcolor{keyword}{const};}
\DoxyCodeLine{132 }
\DoxyCodeLine{133         \textcolor{comment}{// All set field components}}
\DoxyCodeLine{134         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getField(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}\& pos) \textcolor{keyword}{const};}
\DoxyCodeLine{135 \};}
\DoxyCodeLine{136 }
\DoxyCodeLine{137 }
\DoxyCodeLine{149 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1PlanckJF12bField}{PlanckJF12bField}}: \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12Field}} \{}
\DoxyCodeLine{150         \textcolor{keyword}{public}:}
\DoxyCodeLine{151                 \mbox{\hyperlink{classcrpropa_1_1PlanckJF12bField}{PlanckJF12bField}}();}
\DoxyCodeLine{152 \};}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \} \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_JF12FIELD\_H}}

\end{DoxyCode}
