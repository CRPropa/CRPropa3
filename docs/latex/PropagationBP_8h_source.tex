\hypertarget{PropagationBP_8h_source}{}\doxysection{Propagation\+BP.\+h}
\label{PropagationBP_8h_source}\index{PropagationBP.h@{PropagationBP.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_PROPAGATIONBP\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_PROPAGATIONBP\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}crpropa/Module.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Units_8h}{crpropa/Units.h}}"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}crpropa/magneticField/MagneticField.h"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}kiss/logger.h"{}}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{26 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1PropagationBP}{PropagationBP}}: \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1Module}{Module}} \{}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{public}:}
\DoxyCodeLine{29         \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \{}
\DoxyCodeLine{30         \textcolor{keyword}{public}:}
\DoxyCodeLine{31                 \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} x, u; \textcolor{comment}{/*< phase-\/point: position and direction */}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33                 \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}}() \{}
\DoxyCodeLine{34                 \}}
\DoxyCodeLine{35 }
\DoxyCodeLine{36                 \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&x, \textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&u) :}
\DoxyCodeLine{37                                 x(x), u(u) \{}
\DoxyCodeLine{38                 \}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40                 \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}}(\textcolor{keywordtype}{double} f) :}
\DoxyCodeLine{41                                 x(\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}(f, f, f)), u(\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}(f, f, f)) \{}
\DoxyCodeLine{42                 \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44                 \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} operator *(\textcolor{keywordtype}{double} f)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{45                         \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}}(x * f, u * f);}
\DoxyCodeLine{46                 \}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48                 \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&operator +=(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&y) \{}
\DoxyCodeLine{49                         x += y.x;}
\DoxyCodeLine{50                         u += y.u;}
\DoxyCodeLine{51                         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{52                 \}}
\DoxyCodeLine{53         \};}
\DoxyCodeLine{54 }
\DoxyCodeLine{55 \textcolor{keyword}{private}:}
\DoxyCodeLine{56         \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<MagneticField>}} field;}
\DoxyCodeLine{57         \textcolor{keywordtype}{double} tolerance; }
\DoxyCodeLine{58         \textcolor{keywordtype}{double} minStep; }
\DoxyCodeLine{59         \textcolor{keywordtype}{double} maxStep; }
\DoxyCodeLine{61 \textcolor{keyword}{public}:}
\DoxyCodeLine{66         \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a1dae10c65075c130de52a7b6f5b5c542}{PropagationBP}}(\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<MagneticField>}} field = NULL, \textcolor{keywordtype}{double} fixedStep = 1. * kpc);}
\DoxyCodeLine{67 }
\DoxyCodeLine{74     \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a1e995feca2699ca6bd87037fae415752}{PropagationBP}}(\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<MagneticField>}} field, \textcolor{keywordtype}{double} tolerance, \textcolor{keywordtype}{double} minStep, \textcolor{keywordtype}{double} maxStep);}
\DoxyCodeLine{75 }
\DoxyCodeLine{78         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_ab59d2de78ed0589c122df3d6c0478b41}{process}}(\mbox{\hyperlink{classcrpropa_1_1Candidate}{Candidate}} *candidate) \textcolor{keyword}{const};}
\DoxyCodeLine{79 }
\DoxyCodeLine{89         \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a4571f7cbb9927197bb405306c789fcab}{dY}}(\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}  pos, \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}  dir, \textcolor{keywordtype}{double} step, \textcolor{keywordtype}{double} z, \textcolor{keywordtype}{double} q, \textcolor{keywordtype}{double} m) \textcolor{keyword}{const};}
\DoxyCodeLine{90 }
\DoxyCodeLine{97         \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a114dc0d80ebe1c9a993011c262db2dec}{errorEstimation}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} x1, \textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} x2, \textcolor{keywordtype}{double} step) \textcolor{keyword}{const};}
\DoxyCodeLine{98 }
\DoxyCodeLine{104         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a96c7f39fd36d2893d472fc781f1cbed3}{getFieldAtPosition}}(\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} pos, \textcolor{keywordtype}{double} z) \textcolor{keyword}{const};}
\DoxyCodeLine{105 }
\DoxyCodeLine{116         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_aed78cae860289e629f395eb8613a8232}{tryStep}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&y, \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&out, \mbox{\hyperlink{classcrpropa_1_1PropagationBP_1_1Y}{Y}} \&error, \textcolor{keywordtype}{double} h, \mbox{\hyperlink{classcrpropa_1_1ParticleState}{ParticleState}} \&p, \textcolor{keywordtype}{double} z, \textcolor{keywordtype}{double} m, \textcolor{keywordtype}{double} q) \textcolor{keyword}{const};}
\DoxyCodeLine{117 }
\DoxyCodeLine{123         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_ad9d809e7ecc2fc687d96e64cb86220ef}{setField}}(\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<MagneticField>}} field);}
\DoxyCodeLine{127         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_ab775e7293ddd12cd11332ce73d1cdec3}{setTolerance}}(\textcolor{keywordtype}{double} tolerance);}
\DoxyCodeLine{131         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a0b1342c4f83f19cc5f39a3e5bd76d13e}{setMinimumStep}}(\textcolor{keywordtype}{double} minStep);}
\DoxyCodeLine{135         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_a11a631bd22325f3106b56f03fb7375c4}{setMaximumStep}}(\textcolor{keywordtype}{double} maxStep);}
\DoxyCodeLine{136 }
\DoxyCodeLine{139         \mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\_ptr<MagneticField>}} \mbox{\hyperlink{classcrpropa_1_1PropagationBP_aa48029387370c13d184bff20ea2421da}{getField}}() \textcolor{keyword}{const};}
\DoxyCodeLine{140         \textcolor{keywordtype}{double} getTolerance() \textcolor{keyword}{const};}
\DoxyCodeLine{141         \textcolor{keywordtype}{double} getMinimumStep() \textcolor{keyword}{const};}
\DoxyCodeLine{142         \textcolor{keywordtype}{double} getMaximumStep() \textcolor{keyword}{const};}
\DoxyCodeLine{143         std::string getDescription() \textcolor{keyword}{const};}
\DoxyCodeLine{144 \};}
\DoxyCodeLine{147 \} \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{148 }
\DoxyCodeLine{149 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// PROPAGATIONBP\_H}}

\end{DoxyCode}
