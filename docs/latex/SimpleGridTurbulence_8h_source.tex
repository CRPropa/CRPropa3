\hypertarget{SimpleGridTurbulence_8h_source}{}\doxysection{Simple\+Grid\+Turbulence.\+h}
\label{SimpleGridTurbulence_8h_source}\index{SimpleGridTurbulence.h@{SimpleGridTurbulence.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_SIMPLEGRIDTURBULENCE\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_SIMPLEGRIDTURBULENCE\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#ifdef CRPROPA\_HAVE\_FFTW3F}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}crpropa/magneticField/turbulentField/GridTurbulence.h"{}}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}kiss/logger.h"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}kiss/string.h"{}}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{21 \textcolor{keyword}{class }SimpleTurbulenceSpectrum : \textcolor{keyword}{public} TurbulenceSpectrum \{}
\DoxyCodeLine{22   \textcolor{keyword}{public}:}
\DoxyCodeLine{31         SimpleTurbulenceSpectrum(\textcolor{keywordtype}{double} Brms, \textcolor{keywordtype}{double} lMin, \textcolor{keywordtype}{double} lMax,}
\DoxyCodeLine{32                                  \textcolor{keywordtype}{double} sIndex = 5. / 3)}
\DoxyCodeLine{33             : TurbulenceSpectrum(Brms, lMin, lMax, 0, sIndex, 0) \{\}}
\DoxyCodeLine{34         \string~SimpleTurbulenceSpectrum() \{\}}
\DoxyCodeLine{35 }
\DoxyCodeLine{39         \textcolor{keywordtype}{double} energySpectrum(\textcolor{keywordtype}{double} k)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{40                 \textcolor{keywordflow}{return} std::pow(k, -\/getSindex() -\/ 2);}
\DoxyCodeLine{41         \}}
\DoxyCodeLine{42 }
\DoxyCodeLine{48         \textcolor{keywordtype}{double} getCorrelationLength()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{49                 \textcolor{keywordflow}{return} turbulentCorrelationLength(getLmin(), getLmax(),}
\DoxyCodeLine{50                                                   getSindex());}
\DoxyCodeLine{51         \}}
\DoxyCodeLine{52         \textcolor{keyword}{static} \textcolor{keywordtype}{double} turbulentCorrelationLength(\textcolor{keywordtype}{double} lMin, \textcolor{keywordtype}{double} lMax,}
\DoxyCodeLine{53                                                  \textcolor{keywordtype}{double} s) \{}
\DoxyCodeLine{54                 \textcolor{keywordtype}{double} r = lMin / lMax;}
\DoxyCodeLine{55                 \textcolor{keywordflow}{return} lMax / 2 * (s -\/ 1) / s * (1 -\/ pow(r, s)) / (1 -\/ pow(r, s -\/ 1));}
\DoxyCodeLine{56         \}}
\DoxyCodeLine{57 \};}
\DoxyCodeLine{58 }
\DoxyCodeLine{63 \textcolor{keyword}{class }SimpleGridTurbulence : \textcolor{keyword}{public} GridTurbulence \{}
\DoxyCodeLine{64   \textcolor{keyword}{public}:}
\DoxyCodeLine{72         SimpleGridTurbulence(\textcolor{keyword}{const} SimpleTurbulenceSpectrum \&spectrum,}
\DoxyCodeLine{73                              \textcolor{keyword}{const} GridProperties \&gridProp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed = 0);}
\DoxyCodeLine{74 }
\DoxyCodeLine{75         \textcolor{keyword}{static} \textcolor{keywordtype}{void} initTurbulence(ref\_ptr<Grid3f> grid, \textcolor{keywordtype}{double} Brms, \textcolor{keywordtype}{double} lMin,}
\DoxyCodeLine{76                                    \textcolor{keywordtype}{double} lMax, \textcolor{keywordtype}{double} alpha, \textcolor{keywordtype}{int} seed);}
\DoxyCodeLine{77 \};}
\DoxyCodeLine{78 }
\DoxyCodeLine{79 \textcolor{comment}{// Compatibility with old functions from GridTurbulence:}}
\DoxyCodeLine{80 }
\DoxyCodeLine{83 \textcolor{keyword}{inline} \textcolor{keywordtype}{double} turbulentCorrelationLength(\textcolor{keywordtype}{double} lMin, \textcolor{keywordtype}{double} lMax,}
\DoxyCodeLine{84                                          \textcolor{keywordtype}{double} alpha = -\/11 / 3.) \{}
\DoxyCodeLine{85         KISS\_LOG\_WARNING}
\DoxyCodeLine{86             << \textcolor{stringliteral}{"{}turbulentCorrelationLength is deprecated and will be "{}}}
\DoxyCodeLine{87                \textcolor{stringliteral}{"{}removed in the future. Replace it with a more appropriate "{}}}
\DoxyCodeLine{88                \textcolor{stringliteral}{"{}turbulent field model and call getCorrelationLength()."{}};}
\DoxyCodeLine{89         \textcolor{keywordflow}{return} SimpleTurbulenceSpectrum::turbulentCorrelationLength(lMin, lMax,}
\DoxyCodeLine{90                                                                     -\/alpha -\/ 2);}
\DoxyCodeLine{91 \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{102 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} initTurbulence(ref\_ptr<Grid3f> grid, \textcolor{keywordtype}{double} Brms, \textcolor{keywordtype}{double} lMin,}
\DoxyCodeLine{103                            \textcolor{keywordtype}{double} lMax, \textcolor{keywordtype}{double} alpha = -\/11 / 3., \textcolor{keywordtype}{int} seed = 0) \{}
\DoxyCodeLine{104         KISS\_LOG\_WARNING}
\DoxyCodeLine{105             << \textcolor{stringliteral}{"{}initTurbulence is deprecated and will be removed in the future. "{}}}
\DoxyCodeLine{106                \textcolor{stringliteral}{"{}Replace it with a more appropriate turbulent field model instance."{}};}
\DoxyCodeLine{107         SimpleGridTurbulence::initTurbulence(grid, Brms, lMin, lMax, alpha, seed);}
\DoxyCodeLine{108 \}}
\DoxyCodeLine{109 }
\DoxyCodeLine{111 \} \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_HAVE\_FFTW3F}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_SIMPLEGRIDTURBULENCE\_H}}

\end{DoxyCode}
