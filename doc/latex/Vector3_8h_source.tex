\hypertarget{Vector3_8h_source}{}\doxysection{Vector3.\+h}
\label{Vector3_8h_source}\index{Vector3.h@{Vector3.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_VECTOR3\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_VECTOR3\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <limits>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{11 }
\DoxyCodeLine{28 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{29 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}} \{}
\DoxyCodeLine{30 \textcolor{keyword}{public}:}
\DoxyCodeLine{31         \textcolor{keyword}{union }\{}
\DoxyCodeLine{32                 \textcolor{keyword}{struct}}
\DoxyCodeLine{33                 \{}
\DoxyCodeLine{34                         T x;}
\DoxyCodeLine{35                         T y;}
\DoxyCodeLine{36                         T z;}
\DoxyCodeLine{37                 \};}
\DoxyCodeLine{38                 T data[3];}
\DoxyCodeLine{39         \};}
\DoxyCodeLine{40 }
\DoxyCodeLine{41         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}() : data\{0., 0., 0.\} \{}
\DoxyCodeLine{42         \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44         \textcolor{comment}{// avoid creation of default non-\/conversion constructor}}
\DoxyCodeLine{45         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}} \&v) : data\{v.data[0], v.data[1], v.data[2]\} \{}
\DoxyCodeLine{46         \}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48         \textcolor{comment}{// Provides implicit conversion}}
\DoxyCodeLine{49         \textcolor{keyword}{template}<\textcolor{keyword}{typename} U>}
\DoxyCodeLine{50         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<U>}} \&v) \{}
\DoxyCodeLine{51                 data[0] = v.x;}
\DoxyCodeLine{52                 data[1] = v.y;}
\DoxyCodeLine{53                 data[2] = v.z;}
\DoxyCodeLine{54         \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56         \mbox{\hyperlink{classcrpropa_1_1Vector3}{\string~Vector3}}()}
\DoxyCodeLine{57         \{}
\DoxyCodeLine{58         \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60         \textcolor{keyword}{explicit} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} *v) \{}
\DoxyCodeLine{61                 data[0] = v[0];}
\DoxyCodeLine{62                 data[1] = v[1];}
\DoxyCodeLine{63                 data[2] = v[2];}
\DoxyCodeLine{64         \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66         \textcolor{keyword}{explicit} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(\textcolor{keyword}{const} \textcolor{keywordtype}{float} *v) \{}
\DoxyCodeLine{67                 data[0] = v[0];}
\DoxyCodeLine{68                 data[1] = v[1];}
\DoxyCodeLine{69                 data[2] = v[2];}
\DoxyCodeLine{70         \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72         \textcolor{keyword}{explicit} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(\textcolor{keyword}{const} T \&X, \textcolor{keyword}{const} T \&Y, \textcolor{keyword}{const} T \&Z) : data\{X, Y, Z\} \{}
\DoxyCodeLine{73         \}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75         \textcolor{keyword}{explicit} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(T t) : data\{t, t, t\} \{}
\DoxyCodeLine{76         \}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78         \textcolor{keywordtype}{void} setX(\textcolor{keyword}{const} T X) \{}
\DoxyCodeLine{79                 x = X;}
\DoxyCodeLine{80         \}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82         \textcolor{keywordtype}{void} setY(\textcolor{keyword}{const} T Y) \{}
\DoxyCodeLine{83                 y = Y;}
\DoxyCodeLine{84         \}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86         \textcolor{keywordtype}{void} setZ(\textcolor{keyword}{const} T Z) \{}
\DoxyCodeLine{87                 z = Z;}
\DoxyCodeLine{88         \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90         \textcolor{keywordtype}{void} setXYZ(\textcolor{keyword}{const} T X, \textcolor{keyword}{const} T Y, \textcolor{keyword}{const} T Z) \{}
\DoxyCodeLine{91                 x = X;}
\DoxyCodeLine{92                 y = Y;}
\DoxyCodeLine{93                 z = Z;}
\DoxyCodeLine{94         \}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96         \textcolor{keywordtype}{void} setR(\textcolor{keyword}{const} T r) \{}
\DoxyCodeLine{97                 *\textcolor{keyword}{this} *= r / getR();}
\DoxyCodeLine{98         \}}
\DoxyCodeLine{99 }
\DoxyCodeLine{100         \textcolor{keywordtype}{void} setRThetaPhi(\textcolor{keyword}{const} T r, \textcolor{keyword}{const} T theta, \textcolor{keyword}{const} T phi) \{}
\DoxyCodeLine{101                 x = r * sin(theta) * cos(phi);}
\DoxyCodeLine{102                 y = r * sin(theta) * sin(phi);}
\DoxyCodeLine{103                 z = r * cos(theta);}
\DoxyCodeLine{104         \}}
\DoxyCodeLine{105 }
\DoxyCodeLine{106         T getX()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{107                 \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{108         \}}
\DoxyCodeLine{109 }
\DoxyCodeLine{110         T getY()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{111                 \textcolor{keywordflow}{return} y;}
\DoxyCodeLine{112         \}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114         T getZ()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{115                 \textcolor{keywordflow}{return} z;}
\DoxyCodeLine{116         \}}
\DoxyCodeLine{117 }
\DoxyCodeLine{118         \textcolor{comment}{// magnitude (2-\/norm) of the vector}}
\DoxyCodeLine{119         T getR()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{120                 \textcolor{keywordflow}{return} std::sqrt(x * x + y * y + z * z);}
\DoxyCodeLine{121         \}}
\DoxyCodeLine{122 }
\DoxyCodeLine{123         \textcolor{comment}{// square of magnitude of the vector}}
\DoxyCodeLine{124         T getR2()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{125                 \textcolor{keywordflow}{return} x * x + y * y + z * z;}
\DoxyCodeLine{126         \}}
\DoxyCodeLine{127 }
\DoxyCodeLine{128         \textcolor{comment}{// return the azimuth angle}}
\DoxyCodeLine{129         T getPhi()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{130                 T eps = std::numeric\_limits < T > ::min();}
\DoxyCodeLine{131                 \textcolor{keywordflow}{if} ((fabs(x) < eps) \&\& (fabs(y) < eps))}
\DoxyCodeLine{132                         \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{133                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{134                         \textcolor{keywordflow}{return} std::atan2(y, x);}
\DoxyCodeLine{135         \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{137         \textcolor{comment}{// return the zenith angle}}
\DoxyCodeLine{138         T getTheta()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{139                 T eps = std::numeric\_limits < T > ::min();}
\DoxyCodeLine{140                 \textcolor{keywordflow}{if} ((fabs(x) < eps) \&\& (fabs(y) < eps) \&\& (fabs(z) < eps))}
\DoxyCodeLine{141                         \textcolor{keywordflow}{return} 0.0;}
\DoxyCodeLine{142                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{143                         \textcolor{keywordflow}{return} atan2((T) sqrt(x * x + y * y), z);}
\DoxyCodeLine{144         \}}
\DoxyCodeLine{145 }
\DoxyCodeLine{146         \textcolor{comment}{// return the unit-\/vector e\_r}}
\DoxyCodeLine{147         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} getUnitVector()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{148                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this} / getR();}
\DoxyCodeLine{149         \}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151         \textcolor{comment}{// return the unit-\/vector e\_theta}}
\DoxyCodeLine{152         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} getUnitVectorTheta()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{153                 T theta = getTheta();}
\DoxyCodeLine{154                 T phi = getPhi();}
\DoxyCodeLine{155                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(cos(theta) * cos(phi), cos(theta) * sin(phi),}
\DoxyCodeLine{156                                 -\/sin(theta));}
\DoxyCodeLine{157         \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159         \textcolor{comment}{// return the unit-\/vector e\_phi}}
\DoxyCodeLine{160         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} getUnitVectorPhi()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{161                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(-\/sin(getPhi()), cos(getPhi()), 0);}
\DoxyCodeLine{162         \}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164         \textcolor{comment}{// return the angle [0, pi] between the vectors}}
\DoxyCodeLine{165         T getAngleTo(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{166                 T cosdistance = dot(v) / v.getR() / getR();}
\DoxyCodeLine{167                 \textcolor{comment}{// In some directions cosdistance is > 1 on some compilers}}
\DoxyCodeLine{168                 \textcolor{comment}{// This ensures that the correct result is returned}}
\DoxyCodeLine{169                 \textcolor{keywordflow}{if} (cosdistance >= 1.)}
\DoxyCodeLine{170                         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{171                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (cosdistance <= -\/1.)}
\DoxyCodeLine{172                         \textcolor{keywordflow}{return} M\_PI;}
\DoxyCodeLine{173                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{174                         \textcolor{keywordflow}{return} acos(cosdistance);}
\DoxyCodeLine{175         \}}
\DoxyCodeLine{176 }
\DoxyCodeLine{177         \textcolor{comment}{// return true if the angle between the vectors is smaller than a threshold}}
\DoxyCodeLine{178         \textcolor{keywordtype}{bool} isParallelTo(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v, T maxAngle)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{179                 \textcolor{keywordflow}{return} getAngleTo(v) < maxAngle;}
\DoxyCodeLine{180         \}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182         \textcolor{comment}{// linear distance to a given vector}}
\DoxyCodeLine{183         T getDistanceTo(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&point)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{184                 \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} d = *\textcolor{keyword}{this} -\/ point;}
\DoxyCodeLine{185                 \textcolor{keywordflow}{return} d.getR();}
\DoxyCodeLine{186         \}}
\DoxyCodeLine{187 }
\DoxyCodeLine{188         \textcolor{comment}{// return the component parallel to a second vector}}
\DoxyCodeLine{189         \textcolor{comment}{// 0 if the second vector has 0 magnitude}}
\DoxyCodeLine{190         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} getParallelTo(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{191                 T vmag = v.getR();}
\DoxyCodeLine{192                 \textcolor{keywordflow}{if} (vmag == std::numeric\_limits < T > ::min())}
\DoxyCodeLine{193                         \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(0.);}
\DoxyCodeLine{194                 \textcolor{keywordflow}{return} v * dot(v) / vmag;}
\DoxyCodeLine{195         \}}
\DoxyCodeLine{196 }
\DoxyCodeLine{197         \textcolor{comment}{// return the component perpendicular to a second vector}}
\DoxyCodeLine{198         \textcolor{comment}{// 0 if the second vector has 0 magnitude}}
\DoxyCodeLine{199         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} getPerpendicularTo(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{200                 \textcolor{keywordflow}{if} (v.getR() == std::numeric\_limits < T > ::min())}
\DoxyCodeLine{201                         \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(0.);}
\DoxyCodeLine{202                 \textcolor{keywordflow}{return} (*\textcolor{keyword}{this}) -\/ getParallelTo(v);}
\DoxyCodeLine{203         \}}
\DoxyCodeLine{204 }
\DoxyCodeLine{205         \textcolor{comment}{// rotate the vector around a given axis by a given angle}}
\DoxyCodeLine{206         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} getRotated(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&axis, T angle)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{207                 \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} u = axis;}
\DoxyCodeLine{208                 T c = cos(angle);}
\DoxyCodeLine{209                 T s = sin(angle);}
\DoxyCodeLine{210                 \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} Rx(c + u.x * u.x * (1 -\/ c), u.x * u.y * (1 -\/ c) -\/ u.z * s,}
\DoxyCodeLine{211                                 u.x * u.z * (1 -\/ c) + u.y * s);}
\DoxyCodeLine{212                 \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} Ry(u.y * u.x * (1 -\/ c) + u.z * s, c + u.y * u.y * (1 -\/ c),}
\DoxyCodeLine{213                                 u.y * u.z * (1 -\/ c) -\/ u.x * s);}
\DoxyCodeLine{214                 \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} Rz(u.z * u.x * (1 -\/ c) -\/ u.y * s,}
\DoxyCodeLine{215                                 u.z * u.y * (1 -\/ c) + u.x * s, c + u.z * u.z * (1 -\/ c));}
\DoxyCodeLine{216                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(dot(Rx), dot(Ry), dot(Rz));}
\DoxyCodeLine{217         \}}
\DoxyCodeLine{218 }
\DoxyCodeLine{219         \textcolor{comment}{// return vector with values limited to the range [lower, upper]}}
\DoxyCodeLine{220         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} clip(T lower, T upper)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{221                 \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} out;}
\DoxyCodeLine{222                 out.x = std::max(lower, std::min(x, upper));}
\DoxyCodeLine{223                 out.y = std::max(lower, std::min(y, upper));}
\DoxyCodeLine{224                 out.z = std::max(lower, std::min(z, upper));}
\DoxyCodeLine{225                 \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{226         \}}
\DoxyCodeLine{227 }
\DoxyCodeLine{228         \textcolor{comment}{// return vector with absolute values}}
\DoxyCodeLine{229         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} abs()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{230                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(std::abs(x), std::abs(y), std::abs(z));}
\DoxyCodeLine{231         \}}
\DoxyCodeLine{232 }
\DoxyCodeLine{233         \textcolor{comment}{// return vector with floored values}}
\DoxyCodeLine{234         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} floor()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{235                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(std::floor(x), std::floor(y), std::floor(z));}
\DoxyCodeLine{236         \}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238         \textcolor{comment}{// return vector with ceiled values}}
\DoxyCodeLine{239         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} ceil()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{240                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(std::ceil(x), std::ceil(y), std::ceil(z));}
\DoxyCodeLine{241         \}}
\DoxyCodeLine{242 }
\DoxyCodeLine{243         \textcolor{comment}{// minimum element}}
\DoxyCodeLine{244         T min()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{245                 \textcolor{keywordflow}{return} std::min(x, std::min(y, z));}
\DoxyCodeLine{246         \}}
\DoxyCodeLine{247 }
\DoxyCodeLine{248         \textcolor{comment}{// maximum element}}
\DoxyCodeLine{249         T max()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{250                 \textcolor{keywordflow}{return} std::max(x, std::max(y, z));}
\DoxyCodeLine{251         \}}
\DoxyCodeLine{252 }
\DoxyCodeLine{253         \textcolor{comment}{// dot product}}
\DoxyCodeLine{254         T dot(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{255                 \textcolor{keywordflow}{return} x * v.x + y * v.y + z * v.z;}
\DoxyCodeLine{256         \}}
\DoxyCodeLine{257 }
\DoxyCodeLine{258         \textcolor{comment}{// cross product}}
\DoxyCodeLine{259         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} cross(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{260                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}}(y * v.z -\/ v.y * z, z * v.x -\/ v.z * x,}
\DoxyCodeLine{261                                 x * v.y -\/ v.x * y);}
\DoxyCodeLine{262         \}}
\DoxyCodeLine{263 }
\DoxyCodeLine{264         \textcolor{comment}{// returns true if all elements of the two vectors are equal}}
\DoxyCodeLine{265         \textcolor{keywordtype}{bool} operator ==(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{266                 \textcolor{keywordflow}{if} (x != v.x)}
\DoxyCodeLine{267                         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{268                 \textcolor{keywordflow}{if} (y != v.y)}
\DoxyCodeLine{269                         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{270                 \textcolor{keywordflow}{if} (z != v.z)}
\DoxyCodeLine{271                         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{272                 \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{273         \}}
\DoxyCodeLine{274 }
\DoxyCodeLine{275         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator +(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{276                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(x + v.x, y + v.y, z + v.z);}
\DoxyCodeLine{277         \}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator +(\textcolor{keyword}{const} T \&f)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{280                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(x + f, y + f, z + f);}
\DoxyCodeLine{281         \}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator -\/(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{284                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(x -\/ v.x, y -\/ v.y, z -\/ v.z);}
\DoxyCodeLine{285         \}}
\DoxyCodeLine{286 }
\DoxyCodeLine{287         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator -\/(\textcolor{keyword}{const} T \&f)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{288                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(x -\/ f, y -\/ f, z -\/ f);}
\DoxyCodeLine{289         \}}
\DoxyCodeLine{290 }
\DoxyCodeLine{291         \textcolor{comment}{// element-\/wise multiplication}}
\DoxyCodeLine{292         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator *(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{293                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(x * v.x, y * v.y, z * v.z);}
\DoxyCodeLine{294         \}}
\DoxyCodeLine{295 }
\DoxyCodeLine{296         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator *(T v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{297                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(data[0] * v, data[1] * v, data[2] * v);}
\DoxyCodeLine{298         \}}
\DoxyCodeLine{299 }
\DoxyCodeLine{300         \textcolor{comment}{// element-\/wise division}}
\DoxyCodeLine{301         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator /(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{302                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(x / v.x, y / v.y, z / v.z);}
\DoxyCodeLine{303         \}}
\DoxyCodeLine{304 }
\DoxyCodeLine{305         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator /(\textcolor{keyword}{const} T \&f)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{306                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(x / f, y / f, z / f);}
\DoxyCodeLine{307         \}}
\DoxyCodeLine{308 }
\DoxyCodeLine{309         \textcolor{comment}{// element-\/wise modulo operation}}
\DoxyCodeLine{310         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator \%(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{311                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(fmod(x, v.x), fmod(y, v.y), fmod(z, v.z));}
\DoxyCodeLine{312         \}}
\DoxyCodeLine{313 }
\DoxyCodeLine{314         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} operator \%(\textcolor{keyword}{const} T \&f)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{315                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3}}(fmod(x, f), fmod(y, f), fmod(z, f));}
\DoxyCodeLine{316         \}}
\DoxyCodeLine{317 }
\DoxyCodeLine{318         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator -\/=(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v) \{}
\DoxyCodeLine{319                 data[0] -\/= v.x;}
\DoxyCodeLine{320                 data[1] -\/= v.y;}
\DoxyCodeLine{321                 data[2] -\/= v.z;}
\DoxyCodeLine{322                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{323         \}}
\DoxyCodeLine{324 }
\DoxyCodeLine{325         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator -\/=(\textcolor{keyword}{const} T \&f) \{}
\DoxyCodeLine{326                 data[0] -\/= f;}
\DoxyCodeLine{327                 data[1] -\/= f;}
\DoxyCodeLine{328                 data[2] -\/= f;}
\DoxyCodeLine{329                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{330         \}}
\DoxyCodeLine{331 }
\DoxyCodeLine{332         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator +=(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v) \{}
\DoxyCodeLine{333                 data[0] += v.x;}
\DoxyCodeLine{334                 data[1] += v.y;}
\DoxyCodeLine{335                 data[2] += v.z;}
\DoxyCodeLine{336                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{337         \}}
\DoxyCodeLine{338 }
\DoxyCodeLine{339         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator +=(\textcolor{keyword}{const} T \&f) \{}
\DoxyCodeLine{340                 data[0] += f;}
\DoxyCodeLine{341                 data[1] += f;}
\DoxyCodeLine{342                 data[2] += f;}
\DoxyCodeLine{343                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{344         \}}
\DoxyCodeLine{345 }
\DoxyCodeLine{346         \textcolor{comment}{// element-\/wise multiplication}}
\DoxyCodeLine{347         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator *=(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v) \{}
\DoxyCodeLine{348                 data[0] *= v.x;}
\DoxyCodeLine{349                 data[1] *= v.y;}
\DoxyCodeLine{350                 data[2] *= v.z;}
\DoxyCodeLine{351                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{352         \}}
\DoxyCodeLine{353 }
\DoxyCodeLine{354         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator *=(\textcolor{keyword}{const} T \&f) \{}
\DoxyCodeLine{355                 data[0] *= f;}
\DoxyCodeLine{356                 data[1] *= f;}
\DoxyCodeLine{357                 data[2] *= f;}
\DoxyCodeLine{358                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{359         \}}
\DoxyCodeLine{360 }
\DoxyCodeLine{361         \textcolor{comment}{// element-\/wise division}}
\DoxyCodeLine{362         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator /=(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v) \{}
\DoxyCodeLine{363                 data[0] /= v.x;}
\DoxyCodeLine{364                 data[1] /= v.y;}
\DoxyCodeLine{365                 data[2] /= v.z;}
\DoxyCodeLine{366                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{367         \}}
\DoxyCodeLine{368 }
\DoxyCodeLine{369         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator /=(\textcolor{keyword}{const} T \&f) \{}
\DoxyCodeLine{370                 data[0] /= f;}
\DoxyCodeLine{371                 data[1] /= f;}
\DoxyCodeLine{372                 data[2] /= f;}
\DoxyCodeLine{373                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{374         \}}
\DoxyCodeLine{375 }
\DoxyCodeLine{376         \textcolor{comment}{// element-\/wise modulo operation}}
\DoxyCodeLine{377         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator \%=(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v) \{}
\DoxyCodeLine{378                 data[0] = fmod(x, v.x);}
\DoxyCodeLine{379                 data[1] = fmod(y, v.y);}
\DoxyCodeLine{380                 data[2] = fmod(z, v.z);}
\DoxyCodeLine{381                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{382         \}}
\DoxyCodeLine{383 }
\DoxyCodeLine{384         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator \%=(\textcolor{keyword}{const} T \&f) \{}
\DoxyCodeLine{385                 data[0] = fmod(x, f);}
\DoxyCodeLine{386                 data[1] = fmod(y, f);}
\DoxyCodeLine{387                 data[2] = fmod(z, f);}
\DoxyCodeLine{388                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{389         \}}
\DoxyCodeLine{390 }
\DoxyCodeLine{391         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator =(\textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v) \{}
\DoxyCodeLine{392                 data[0] = v.x;}
\DoxyCodeLine{393                 data[1] = v.y;}
\DoxyCodeLine{394                 data[2] = v.z;}
\DoxyCodeLine{395                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{396         \}}
\DoxyCodeLine{397 }
\DoxyCodeLine{398         \textcolor{comment}{//Vector3<T> \&operator =(Vector3<T> \&\&v) noexcept \{}}
\DoxyCodeLine{399         \textcolor{comment}{//      data[0] = v.data[0];}}
\DoxyCodeLine{400         \textcolor{comment}{//      data[1] = v.data[1];}}
\DoxyCodeLine{401         \textcolor{comment}{//      data[2] = v.data[2];}}
\DoxyCodeLine{402         \textcolor{comment}{//      return *this;}}
\DoxyCodeLine{403         \textcolor{comment}{//\}}}
\DoxyCodeLine{404 }
\DoxyCodeLine{405         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&operator =(\textcolor{keyword}{const} T \&f) \{}
\DoxyCodeLine{406                 data[0] = f;}
\DoxyCodeLine{407                 data[1] = f;}
\DoxyCodeLine{408                 data[2] = f;}
\DoxyCodeLine{409                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{410         \}}
\DoxyCodeLine{411 \};}
\DoxyCodeLine{412 }
\DoxyCodeLine{413 \textcolor{preprocessor}{\#ifndef SWIG}}
\DoxyCodeLine{414 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{415 \textcolor{keyword}{inline} std::ostream \&operator <<(std::ostream \&out, \textcolor{keyword}{const} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3<T>}} \&v) \{}
\DoxyCodeLine{416         out << v.x << \textcolor{stringliteral}{"{} "{}} << v.y << \textcolor{stringliteral}{"{} "{}} << v.z;}
\DoxyCodeLine{417         \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{418 \}}
\DoxyCodeLine{419 }
\DoxyCodeLine{420 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{421 \textcolor{keyword}{inline} std::istream \&operator >>(std::istream \&in, Vector3<T> \&v) \{}
\DoxyCodeLine{422         in >> v.x >> v.y >> v.z;}
\DoxyCodeLine{423         \textcolor{keywordflow}{return} in;}
\DoxyCodeLine{424 \}}
\DoxyCodeLine{425 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{426 }
\DoxyCodeLine{427 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T>}
\DoxyCodeLine{428 \textcolor{keyword}{inline} Vector3<T> operator *(T f, \textcolor{keyword}{const} Vector3<T> \&v) \{}
\DoxyCodeLine{429         \textcolor{keywordflow}{return} Vector3<T>(v.x * f, v.y * f, v.z * f);}
\DoxyCodeLine{430 \}}
\DoxyCodeLine{431 }
\DoxyCodeLine{432 \textcolor{keyword}{typedef} Vector3<double> Vector3d;}
\DoxyCodeLine{433 \textcolor{keyword}{typedef} Vector3<float> Vector3f;}
\DoxyCodeLine{434 }
\DoxyCodeLine{436 \}  \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{437 }
\DoxyCodeLine{438 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// CRPROPA\_VECTOR3\_H}}

\end{DoxyCode}
