<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CRPropa 3.0: PropagationBP Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CRPropa 3.0
   </div>
   <div id="projectbrief">Tracking</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecrpropa.html">crpropa</a></li><li class="navelem"><a class="el" href="classcrpropa_1_1PropagationBP.html">PropagationBP</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classcrpropa_1_1PropagationBP-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PropagationBP Class Reference<div class="ingroups"><a class="el" href="group__Propagation.html">Propagation Modules</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Propagation through magnetic fields using the Boris method.  
 <a href="classcrpropa_1_1PropagationBP.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="PropagationBP_8h_source.html">crpropa/module/PropagationBP.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PropagationBP:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classcrpropa_1_1PropagationBP.png" usemap="#PropagationBP_map" alt=""/>
  <map id="PropagationBP_map" name="PropagationBP_map">
<area href="classcrpropa_1_1Module.html" title="Abstract base class for modules." alt="Module" shape="rect" coords="0,56,96,80"/>
<area href="classcrpropa_1_1Referenced.html" title="Base class for reference counting." alt="Referenced" shape="rect" coords="0,0,96,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1dae10c65075c130de52a7b6f5b5c542"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#a1dae10c65075c130de52a7b6f5b5c542">PropagationBP</a> (<a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1MagneticField.html">MagneticField</a> &gt; field=NULL, double fixedStep=1. *kpc)</td></tr>
<tr class="separator:a1dae10c65075c130de52a7b6f5b5c542"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e995feca2699ca6bd87037fae415752"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#a1e995feca2699ca6bd87037fae415752">PropagationBP</a> (<a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1MagneticField.html">MagneticField</a> &gt; field, double tolerance, double minStep, double maxStep)</td></tr>
<tr class="separator:a1e995feca2699ca6bd87037fae415752"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59d2de78ed0589c122df3d6c0478b41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#ab59d2de78ed0589c122df3d6c0478b41">process</a> (<a class="el" href="classcrpropa_1_1Candidate.html">Candidate</a> *candidate) const</td></tr>
<tr class="separator:ab59d2de78ed0589c122df3d6c0478b41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4571f7cbb9927197bb405306c789fcab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#a4571f7cbb9927197bb405306c789fcab">dY</a> (<a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a> pos, <a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a> dir, double step, double z, double q, double m) const</td></tr>
<tr class="separator:a4571f7cbb9927197bb405306c789fcab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114dc0d80ebe1c9a993011c262db2dec"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#a114dc0d80ebe1c9a993011c262db2dec">errorEstimation</a> (const <a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a> x1, const <a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a> x2, double step) const</td></tr>
<tr class="separator:a114dc0d80ebe1c9a993011c262db2dec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96c7f39fd36d2893d472fc781f1cbed3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#a96c7f39fd36d2893d472fc781f1cbed3">getFieldAtPosition</a> (<a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a> pos, double z) const</td></tr>
<tr class="separator:a96c7f39fd36d2893d472fc781f1cbed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed78cae860289e629f395eb8613a8232"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#aed78cae860289e629f395eb8613a8232">tryStep</a> (const <a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a> &amp;y, <a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a> &amp;out, <a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a> &amp;error, double h, <a class="el" href="classcrpropa_1_1ParticleState.html">ParticleState</a> &amp;p, double z, double m, double q) const</td></tr>
<tr class="separator:aed78cae860289e629f395eb8613a8232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d809e7ecc2fc687d96e64cb86220ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#ad9d809e7ecc2fc687d96e64cb86220ef">setField</a> (<a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1MagneticField.html">MagneticField</a> &gt; field)</td></tr>
<tr class="separator:ad9d809e7ecc2fc687d96e64cb86220ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab775e7293ddd12cd11332ce73d1cdec3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#ab775e7293ddd12cd11332ce73d1cdec3">setTolerance</a> (double tolerance)</td></tr>
<tr class="separator:ab775e7293ddd12cd11332ce73d1cdec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b1342c4f83f19cc5f39a3e5bd76d13e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#a0b1342c4f83f19cc5f39a3e5bd76d13e">setMinimumStep</a> (double minStep)</td></tr>
<tr class="separator:a0b1342c4f83f19cc5f39a3e5bd76d13e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11a631bd22325f3106b56f03fb7375c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#a11a631bd22325f3106b56f03fb7375c4">setMaximumStep</a> (double maxStep)</td></tr>
<tr class="separator:a11a631bd22325f3106b56f03fb7375c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa48029387370c13d184bff20ea2421da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1MagneticField.html">MagneticField</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#aa48029387370c13d184bff20ea2421da">getField</a> () const</td></tr>
<tr class="separator:aa48029387370c13d184bff20ea2421da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1651d37454cc7d2973a5816fb86fb904"><td class="memItemLeft" align="right" valign="top"><a id="a1651d37454cc7d2973a5816fb86fb904" name="a1651d37454cc7d2973a5816fb86fb904"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>getTolerance</b> () const</td></tr>
<tr class="separator:a1651d37454cc7d2973a5816fb86fb904"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa21f57f6f16a13774ce009e63005ab09"><td class="memItemLeft" align="right" valign="top"><a id="aa21f57f6f16a13774ce009e63005ab09" name="aa21f57f6f16a13774ce009e63005ab09"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>getMinimumStep</b> () const</td></tr>
<tr class="separator:aa21f57f6f16a13774ce009e63005ab09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35970f0d50e796aedceffa148be99c2e"><td class="memItemLeft" align="right" valign="top"><a id="a35970f0d50e796aedceffa148be99c2e" name="a35970f0d50e796aedceffa148be99c2e"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>getMaximumStep</b> () const</td></tr>
<tr class="separator:a35970f0d50e796aedceffa148be99c2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea425314aebc36d0f6bf7671705158da"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcrpropa_1_1PropagationBP.html#aea425314aebc36d0f6bf7671705158da">getDescription</a> () const</td></tr>
<tr class="separator:aea425314aebc36d0f6bf7671705158da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3406b56004afdbe7a1815a541d40de99"><td class="memItemLeft" align="right" valign="top"><a id="a3406b56004afdbe7a1815a541d40de99" name="a3406b56004afdbe7a1815a541d40de99"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setDescription</b> (const std::string &amp;description)</td></tr>
<tr class="separator:a3406b56004afdbe7a1815a541d40de99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f2321c49330b61a52ce55c2015e4c49"><td class="memItemLeft" align="right" valign="top"><a id="a9f2321c49330b61a52ce55c2015e4c49" name="a9f2321c49330b61a52ce55c2015e4c49"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>process</b> (<a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1Candidate.html">Candidate</a> &gt; candidate) const</td></tr>
<tr class="separator:a9f2321c49330b61a52ce55c2015e4c49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef7442f4d857baf3d3a39fdeec4aadd"><td class="memItemLeft" align="right" valign="top"><a id="a6ef7442f4d857baf3d3a39fdeec4aadd" name="a6ef7442f4d857baf3d3a39fdeec4aadd"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>addReference</b> () const</td></tr>
<tr class="separator:a6ef7442f4d857baf3d3a39fdeec4aadd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9f5dbbba1431274016b3d74426953f2"><td class="memItemLeft" align="right" valign="top"><a id="ab9f5dbbba1431274016b3d74426953f2" name="ab9f5dbbba1431274016b3d74426953f2"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>removeReference</b> () const</td></tr>
<tr class="separator:ab9f5dbbba1431274016b3d74426953f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adab41cca5664d4668930f93beefa39b5"><td class="memItemLeft" align="right" valign="top"><a id="adab41cca5664d4668930f93beefa39b5" name="adab41cca5664d4668930f93beefa39b5"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>removeReferenceNoDelete</b> () const</td></tr>
<tr class="separator:adab41cca5664d4668930f93beefa39b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74487fc4399bfa67c7251dae5d4247cd"><td class="memItemLeft" align="right" valign="top"><a id="a74487fc4399bfa67c7251dae5d4247cd" name="a74487fc4399bfa67c7251dae5d4247cd"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>getReferenceCount</b> () const</td></tr>
<tr class="separator:a74487fc4399bfa67c7251dae5d4247cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Propagation through magnetic fields using the Boris method. </p>
<p >This module solves the equations of motion of a relativistic charged particle when propagating through a magnetic field.<br  />
It uses the Boris push integration method.<br  />
It can be used with a fixed step size or an adaptive version which supports the step size control. The step size control tries to keep the relative error close to, but smaller than the designated tolerance. Additionally a minimum and maximum size for the steps can be set. For neutral particles a rectilinear propagation is applied and a next step of the maximum step size proposed. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1dae10c65075c130de52a7b6f5b5c542" name="a1dae10c65075c130de52a7b6f5b5c542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dae10c65075c130de52a7b6f5b5c542">&#9670;&nbsp;</a></span>PropagationBP() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcrpropa_1_1PropagationBP.html">PropagationBP</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1MagneticField.html">MagneticField</a> &gt;&#160;</td>
          <td class="paramname"><em>field</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fixedStep</em> = <code>1.&#160;*kpc</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >maximum step size of the propagation Default constructor for the Boris push. It is constructed with a fixed step size. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td></td></tr>
    <tr><td class="paramname">fixedStep</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1e995feca2699ca6bd87037fae415752" name="a1e995feca2699ca6bd87037fae415752"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e995feca2699ca6bd87037fae415752">&#9670;&nbsp;</a></span>PropagationBP() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcrpropa_1_1PropagationBP.html">PropagationBP</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1MagneticField.html">MagneticField</a> &gt;&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxStep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Constructor for the adaptive Boris push. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td></td></tr>
    <tr><td class="paramname">tolerance</td><td>tolerance is criterion for step adjustment. Step adjustment takes place only if minStep &lt; maxStep </td></tr>
    <tr><td class="paramname">minStep</td><td>minStep/c_light is the minimum integration time step </td></tr>
    <tr><td class="paramname">maxStep</td><td>maxStep/c_light is the maximum integration time step. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4571f7cbb9927197bb405306c789fcab" name="a4571f7cbb9927197bb405306c789fcab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4571f7cbb9927197bb405306c789fcab">&#9670;&nbsp;</a></span>dY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a> dY </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a>&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a>&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculates the new position and direction of the particle based on the solution of the Lorentz force </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>current position of the candidate </td></tr>
    <tr><td class="paramname">dir</td><td>current direction of the candidate </td></tr>
    <tr><td class="paramname">step</td><td>current step size of the candidate </td></tr>
    <tr><td class="paramname">z</td><td>current redshift is needed to calculate the magnetic field </td></tr>
    <tr><td class="paramname">q</td><td>current charge of the candidate </td></tr>
    <tr><td class="paramname">m</td><td>current mass of the candidate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>return the new calculated position and direction of the candidate </dd></dl>

</div>
</div>
<a id="a114dc0d80ebe1c9a993011c262db2dec" name="a114dc0d80ebe1c9a993011c262db2dec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114dc0d80ebe1c9a993011c262db2dec">&#9670;&nbsp;</a></span>errorEstimation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double errorEstimation </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a>&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a>&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >comparison of the position after one step with the position after two steps with step/2. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x1</td><td>position after one step of size step </td></tr>
    <tr><td class="paramname">x2</td><td>position after two steps of size step/2 </td></tr>
    <tr><td class="paramname">step</td><td>current step size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>measurement of the error of the step </dd></dl>

</div>
</div>
<a id="aea425314aebc36d0f6bf7671705158da" name="aea425314aebc36d0f6bf7671705158da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea425314aebc36d0f6bf7671705158da">&#9670;&nbsp;</a></span>getDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string getDescription </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classcrpropa_1_1Module.html">Module</a>.</p>

</div>
</div>
<a id="aa48029387370c13d184bff20ea2421da" name="aa48029387370c13d184bff20ea2421da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa48029387370c13d184bff20ea2421da">&#9670;&nbsp;</a></span>getField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1MagneticField.html">MagneticField</a> &gt; getField </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Get functions for the parameters of the class <a class="el" href="classcrpropa_1_1PropagationBP.html" title="Propagation through magnetic fields using the Boris method.">PropagationBP</a>, similar to the set functions </p>

</div>
</div>
<a id="a96c7f39fd36d2893d472fc781f1cbed3" name="a96c7f39fd36d2893d472fc781f1cbed3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96c7f39fd36d2893d472fc781f1cbed3">&#9670;&nbsp;</a></span>getFieldAtPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a> getFieldAtPosition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1Vector3.html">Vector3d</a>&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Get magnetic field vector at current candidate position </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>current position of the candidate </td></tr>
    <tr><td class="paramname">z</td><td>current redshift is needed to calculate the magnetic field </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>magnetic field vector at the position pos </dd></dl>

</div>
</div>
<a id="ab59d2de78ed0589c122df3d6c0478b41" name="ab59d2de78ed0589c122df3d6c0478b41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab59d2de78ed0589c122df3d6c0478b41">&#9670;&nbsp;</a></span>process()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1Candidate.html">Candidate</a> *&#160;</td>
          <td class="paramname"><em>candidate</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Propagates the particle. Is called once per iteration. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">candidate</td><td>The <a class="el" href="classcrpropa_1_1Candidate.html" title="All information about the cosmic ray.">Candidate</a> is a passive object, that holds the information about the state of the cosmic ray and the simulation itself. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classcrpropa_1_1Module.html">Module</a>.</p>

</div>
</div>
<a id="ad9d809e7ecc2fc687d96e64cb86220ef" name="ad9d809e7ecc2fc687d96e64cb86220ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d809e7ecc2fc687d96e64cb86220ef">&#9670;&nbsp;</a></span>setField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1ref__ptr.html">ref_ptr</a>&lt; <a class="el" href="classcrpropa_1_1MagneticField.html">MagneticField</a> &gt;&#160;</td>
          <td class="paramname"><em>field</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Set functions for the parameters of the class <a class="el" href="classcrpropa_1_1PropagationBP.html" title="Propagation through magnetic fields using the Boris method.">PropagationBP</a> Set a specific magnetic field </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>specific magnetic field </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a11a631bd22325f3106b56f03fb7375c4" name="a11a631bd22325f3106b56f03fb7375c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11a631bd22325f3106b56f03fb7375c4">&#9670;&nbsp;</a></span>setMaximumStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setMaximumStep </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxStep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Set the maximum step for the Boris push </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">maxStep</td><td>maxStep/c_light is the maximum integration time step </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0b1342c4f83f19cc5f39a3e5bd76d13e" name="a0b1342c4f83f19cc5f39a3e5bd76d13e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b1342c4f83f19cc5f39a3e5bd76d13e">&#9670;&nbsp;</a></span>setMinimumStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setMinimumStep </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minStep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Set the minimum step for the Boris push </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">minStep</td><td>minStep/c_light is the minimum integration time step </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab775e7293ddd12cd11332ce73d1cdec3" name="ab775e7293ddd12cd11332ce73d1cdec3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab775e7293ddd12cd11332ce73d1cdec3">&#9670;&nbsp;</a></span>setTolerance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setTolerance </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>tolerance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Set a specific tolerance for the step size adaption </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tolerance</td><td>tolerance is criterion for step adjustment. Step adjustment takes place only if minStep &lt; maxStep. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aed78cae860289e629f395eb8613a8232" name="aed78cae860289e629f395eb8613a8232"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed78cae860289e629f395eb8613a8232">&#9670;&nbsp;</a></span>tryStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tryStep </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a> &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a> &amp;&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1PropagationBP_1_1Y.html">Y</a> &amp;&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcrpropa_1_1ParticleState.html">ParticleState</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Adapt step size if required and calculates the new position and direction of the particle with the usage of the function dY </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y</td><td>current position and direction of candidate </td></tr>
    <tr><td class="paramname">out</td><td>position and direction of candidate after the step </td></tr>
    <tr><td class="paramname">error</td><td>error for the current step </td></tr>
    <tr><td class="paramname">h</td><td>current step size </td></tr>
    <tr><td class="paramname">p</td><td>current particle state </td></tr>
    <tr><td class="paramname">z</td><td>current red shift </td></tr>
    <tr><td class="paramname">m</td><td>current mass of the candidate </td></tr>
    <tr><td class="paramname">q</td><td>current charge of the candidate </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 18 2021 22:55:46 for CRPropa 3.0 by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
