\hypertarget{JF12FieldSolenoidal_8h_source}{}\doxysection{JF12\+Field\+Solenoidal.\+h}
\label{JF12FieldSolenoidal_8h_source}\index{JF12FieldSolenoidal.h@{JF12FieldSolenoidal.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_JF12FIELDSOLENOIDAL\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_JF12FIELDSOLENOIDAL\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}crpropa/magneticField/JF12Field.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}crpropa/Grid.h"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Units_8h}{crpropa/Units.h}}"{}}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{9 }
\DoxyCodeLine{28 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal}{JF12FieldSolenoidal}}: \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12Field}} \{}
\DoxyCodeLine{29 \textcolor{keyword}{private}:}
\DoxyCodeLine{30         \textcolor{keywordtype}{double} zS; \textcolor{comment}{// height parameter of the modified X-\/field, field lines are parabolic for fabs(z) < zS}}
\DoxyCodeLine{31         \textcolor{keywordtype}{double} phi0Arms[11]; \textcolor{comment}{// azimuth angles in [-\/pi,pi] at which the dividing 8 spirals of the disk field intersect the (r1 = 5kpc)-\/ring at indices 1 to 8, remaining angles periodically filled.}}
\DoxyCodeLine{32 }
\DoxyCodeLine{33         \textcolor{keywordtype}{double} phi0; \textcolor{comment}{// lower bound for azimuth phi integration to restore solenoidality of spiral field transition, arbitrary parameter}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35         \textcolor{comment}{// in order to restore solenoidality in the transition regions of the spiral field,}}
\DoxyCodeLine{36         \textcolor{comment}{// a phi-\/integral over the piecwise constant field strengths at r=5kpc has to be evaluated. Here,}}
\DoxyCodeLine{37         \textcolor{comment}{// we set H(phi) = phiCoeff[j] + bDisk[j] * phi as the result of this integration}}
\DoxyCodeLine{38         \textcolor{keywordtype}{double} phiCoeff[10]; \textcolor{comment}{// only 10 since the array holds the results for the integral from phi0Arms[0] to phi0Arms[1]; phi0Arms[0] to phi0Arms[2] etc.}}
\DoxyCodeLine{39         \textcolor{keywordtype}{double} corr; \textcolor{comment}{// correction term for enforcing H(phi0) = 0 afterwards which sets the lower boundary of the integration to phi0}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41         \textcolor{comment}{// inner and outer boundaries of disk field at r = 5 and 20 kpc}}
\DoxyCodeLine{42         \textcolor{keywordtype}{double} r1;}
\DoxyCodeLine{43         \textcolor{keywordtype}{double} r2;}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{comment}{// transitions region boundaries of disk field at r1 + delta, r2 -\/ delta}}
\DoxyCodeLine{46         \textcolor{keywordtype}{double} r1s;}
\DoxyCodeLine{47         \textcolor{keywordtype}{double} r2s;}
\DoxyCodeLine{48 }
\DoxyCodeLine{49 \textcolor{keyword}{public}:}
\DoxyCodeLine{54         \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a3b32b78f720abb63da40654c0f2a52f4}{JF12FieldSolenoidal}}(\textcolor{keywordtype}{double} delta = 3 * kpc, \textcolor{keywordtype}{double} zs = 0.5 * kpc);}
\DoxyCodeLine{55 }
\DoxyCodeLine{56         \textcolor{keywordtype}{void} setUseStriatedField(\textcolor{keywordtype}{bool} use); \textcolor{comment}{// override these for correct warning messages}}
\DoxyCodeLine{57         \textcolor{keywordtype}{void} setUseTurbulentField(\textcolor{keywordtype}{bool} use);}
\DoxyCodeLine{58 }
\DoxyCodeLine{63         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a8df94792f850c1390852805e1e3afdaa}{setDiskTransitionWidth}}(\textcolor{keywordtype}{double} delta);}
\DoxyCodeLine{64         \textcolor{keywordtype}{double} getDiskTransitionWidth() \textcolor{keyword}{const};}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 }
\DoxyCodeLine{71         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a68c63b7ecb31850d0d1c95963072fd8d}{setXScaleHeight}}(\textcolor{keywordtype}{double} zs);}
\DoxyCodeLine{72         \textcolor{keywordtype}{double} getXScaleHeight() \textcolor{keyword}{const};}
\DoxyCodeLine{73 }
\DoxyCodeLine{74         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getXField(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& z, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& sinPhi, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& cosPhi) \textcolor{keyword}{const}; \textcolor{comment}{// override old X and spiral field}}
\DoxyCodeLine{75         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getDiskField(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& z, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& phi, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& sinPhi, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& cosPhi) \textcolor{keyword}{const};}
\DoxyCodeLine{76 }
\DoxyCodeLine{81         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_ae676ee9f1ce661e04afd3935b91daefb}{deactivateOuterTransition}}();}
\DoxyCodeLine{82 }
\DoxyCodeLine{88         \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a474768fcad3536c2f402e3925eec5e15}{getDiskTransitionPolynomial}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r) \textcolor{keyword}{const};}
\DoxyCodeLine{89 }
\DoxyCodeLine{94         \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a2db63fef2469b5fd3100b8f8fd03c7f5}{getDiskTransitionPolynomialDerivative}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r) \textcolor{keyword}{const};}
\DoxyCodeLine{95 }
\DoxyCodeLine{101         \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_ae5053c1cf86e9648d4c0b72671dfd965}{getHPhiIntegral}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& phi) \textcolor{keyword}{const};}
\DoxyCodeLine{102 }
\DoxyCodeLine{108         \textcolor{keywordtype}{double} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a7f3a5fc09d90f399b78c8f6173cf4aae}{getSpiralFieldStrengthConstant}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& r, \textcolor{keyword}{const} \textcolor{keywordtype}{double}\& phi) \textcolor{keyword}{const};}
\DoxyCodeLine{109 \};}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 \} \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_JF12FIELDSOLENOIDAL\_H}}

\end{DoxyCode}
