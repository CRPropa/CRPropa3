\hypertarget{GalacticMagneticField_8h_source}{}\doxysection{Galactic\+Magnetic\+Field.\+h}
\label{GalacticMagneticField_8h_source}\index{GalacticMagneticField.h@{GalacticMagneticField.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_GALACTICMAGNETICFIELD\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_GALACTICMAGNETICFIELD\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}crpropa/magneticField/MagneticField.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{8 }
\DoxyCodeLine{13 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1TorroidalHaloField}{TorroidalHaloField}}: \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1MagneticField}{MagneticField}} \{}
\DoxyCodeLine{14         \textcolor{keywordtype}{double} b0; \textcolor{comment}{// halo field strength}}
\DoxyCodeLine{15         \textcolor{keywordtype}{double} z0; \textcolor{comment}{// vertical position}}
\DoxyCodeLine{16         \textcolor{keywordtype}{double} z1; \textcolor{comment}{// vertical scale}}
\DoxyCodeLine{17         \textcolor{keywordtype}{double} r0; \textcolor{comment}{// radial scale}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{public}:}
\DoxyCodeLine{20         \textcolor{keywordtype}{void} setParameters(\textcolor{keywordtype}{double} b0, \textcolor{keywordtype}{double} z0, \textcolor{keywordtype}{double} z1, \textcolor{keywordtype}{double} r0) \{}
\DoxyCodeLine{21                 this-\/>b0 = b0;}
\DoxyCodeLine{22                 this-\/>z0 = z0;}
\DoxyCodeLine{23                 this-\/>z1 = z1;}
\DoxyCodeLine{24                 this-\/>r0 = r0;}
\DoxyCodeLine{25         \}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getField(\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} pos) \{}
\DoxyCodeLine{28                 \textcolor{keywordtype}{double} r = sqrt(pos.x * pos.x + pos.y * pos.y) / r0; \textcolor{comment}{// in-\/plane radius in units of the radial scale}}
\DoxyCodeLine{29                 \textcolor{keywordtype}{double} b = b0 / (1 + pow((std::fabs(pos.z) -\/ z0) / z1, 2)) * r * exp(1 -\/ r);}
\DoxyCodeLine{30                 \textcolor{keywordtype}{double} phi = pos.getPhi(); \textcolor{comment}{// azimuth}}
\DoxyCodeLine{31                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}(cos(phi), sin(phi), 0) * b;}
\DoxyCodeLine{32         \}}
\DoxyCodeLine{33 \};}
\DoxyCodeLine{34 }
\DoxyCodeLine{39 \textcolor{keyword}{class }\mbox{\hyperlink{classcrpropa_1_1LogarithmicSpiralField}{LogarithmicSpiralField}}: \textcolor{keyword}{public} \mbox{\hyperlink{classcrpropa_1_1MagneticField}{MagneticField}} \{}
\DoxyCodeLine{40 \textcolor{keyword}{private}:}
\DoxyCodeLine{41         \textcolor{keywordtype}{bool} isBSS;   \textcolor{comment}{// true for BSS, false for ASS}}
\DoxyCodeLine{42         \textcolor{keywordtype}{double} b0;    \textcolor{comment}{// field strength}}
\DoxyCodeLine{43         \textcolor{keywordtype}{double} pitch; \textcolor{comment}{// pitch angle [rad]}}
\DoxyCodeLine{44         \textcolor{keywordtype}{double} rsol;  \textcolor{comment}{// distance of sun to galactic center}}
\DoxyCodeLine{45         \textcolor{keywordtype}{double} rc;    \textcolor{comment}{// radius of central region with constant field strength}}
\DoxyCodeLine{46         \textcolor{keywordtype}{double} d;     \textcolor{comment}{// distance to the first field reversal}}
\DoxyCodeLine{47         \textcolor{keywordtype}{double} z0;    \textcolor{comment}{// vertical attenuation length}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49         \textcolor{keywordtype}{double} phase; \textcolor{comment}{// phase of the spiral arms}}
\DoxyCodeLine{50         \textcolor{keywordtype}{double} cosPhase;}
\DoxyCodeLine{51         \textcolor{keywordtype}{double} sinPitch;}
\DoxyCodeLine{52         \textcolor{keywordtype}{double} cosPitch;}
\DoxyCodeLine{53         \textcolor{keywordtype}{double} tanPitch;}
\DoxyCodeLine{54 }
\DoxyCodeLine{55         \textcolor{keywordtype}{void} updatePitchAngle() \{}
\DoxyCodeLine{56                 sinPitch = sin(pitch);}
\DoxyCodeLine{57                 cosPitch = cos(pitch);}
\DoxyCodeLine{58                 tanPitch = tan(pitch);}
\DoxyCodeLine{59         \}}
\DoxyCodeLine{60 }
\DoxyCodeLine{61         \textcolor{keywordtype}{void} updatePhase() \{}
\DoxyCodeLine{62                 phase = log(1 + d / rsol) / tanPitch -\/ M\_PI / 2;}
\DoxyCodeLine{63                 cosPhase = cos(phase);}
\DoxyCodeLine{64         \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{keyword}{public}:}
\DoxyCodeLine{67         \textcolor{keywordtype}{void} setParameters(\textcolor{keywordtype}{bool} isBSS, \textcolor{keywordtype}{double} b0, \textcolor{keywordtype}{double} pitch, \textcolor{keywordtype}{double} rsol,}
\DoxyCodeLine{68                         \textcolor{keywordtype}{double} rc, \textcolor{keywordtype}{double} d, \textcolor{keywordtype}{double} z0) \{}
\DoxyCodeLine{69                 this-\/>isBSS = isBSS;}
\DoxyCodeLine{70                 this-\/>b0 = b0;}
\DoxyCodeLine{71                 this-\/>pitch = pitch;}
\DoxyCodeLine{72                 this-\/>rsol = rsol;}
\DoxyCodeLine{73                 this-\/>rc = rc;}
\DoxyCodeLine{74                 this-\/>d = d;}
\DoxyCodeLine{75                 this-\/>z0 = z0;}
\DoxyCodeLine{76                 updatePitchAngle();}
\DoxyCodeLine{77                 updatePhase();}
\DoxyCodeLine{78         \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80         \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} getField(\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} pos)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{81                 \textcolor{keywordtype}{double} r = sqrt(pos.x * pos.x + pos.y * pos.y); \textcolor{comment}{// in-\/plane radius}}
\DoxyCodeLine{82                 \textcolor{keywordtype}{double} b = b0 / cosPhase * rsol / std::max(r, rc);}
\DoxyCodeLine{83 }
\DoxyCodeLine{84                 \textcolor{keywordtype}{double} phi = pos.getPhi();}
\DoxyCodeLine{85                 \textcolor{keywordtype}{double} c = cos(phi -\/ log(r / rsol) / tanPitch + phase);}
\DoxyCodeLine{86                 \textcolor{keywordflow}{if} (isBSS)}
\DoxyCodeLine{87                         c = std::fabs(c);}
\DoxyCodeLine{88                 b *= c * exp(std::fabs(pos.z) / z0);}
\DoxyCodeLine{89 }
\DoxyCodeLine{90                 \textcolor{keywordflow}{return} \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}}(cosPitch * cos(phi), sinPitch * sin(phi), 0) * b;}
\DoxyCodeLine{91         \}}
\DoxyCodeLine{92 \};}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 \}\textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_GALACTICMAGNETICFIELD\_H}}

\end{DoxyCode}
