\hypertarget{GridTurbulence_8h_source}{}\doxysection{Grid\+Turbulence.\+h}
\label{GridTurbulence_8h_source}\index{GridTurbulence.h@{GridTurbulence.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_GRIDTURBULENCE\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_GRIDTURBULENCE\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#ifdef CRPROPA\_HAVE\_FFTW3F}}
\DoxyCodeLine{5 }
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}crpropa/Grid.h"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}crpropa/magneticField/turbulentField/TurbulentField.h"{}}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}fftw3.h"{}}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{21 \textcolor{keyword}{class }GridTurbulence : \textcolor{keyword}{public} TurbulentField \{}
\DoxyCodeLine{22   \textcolor{keyword}{protected}:}
\DoxyCodeLine{23         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed;}
\DoxyCodeLine{24         ref\_ptr<Grid3f> gridPtr;}
\DoxyCodeLine{25 }
\DoxyCodeLine{26         \textcolor{keywordtype}{void} initGrid(\textcolor{keyword}{const} GridProperties \&grid);}
\DoxyCodeLine{27         \textcolor{keywordtype}{void} initTurbulence();}
\DoxyCodeLine{28 }
\DoxyCodeLine{29   \textcolor{keyword}{public}:}
\DoxyCodeLine{37         GridTurbulence(\textcolor{keyword}{const} TurbulenceSpectrum \&spectum,}
\DoxyCodeLine{38                        \textcolor{keyword}{const} GridProperties \&gridProp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed = 0);}
\DoxyCodeLine{39 }
\DoxyCodeLine{40         Vector3d getField(\textcolor{keyword}{const} Vector3d \&pos) \textcolor{keyword}{const};}
\DoxyCodeLine{41 }
\DoxyCodeLine{43         \textcolor{keyword}{const} ref\_ptr<Grid3f> \&getGrid() \textcolor{keyword}{const};}
\DoxyCodeLine{44 }
\DoxyCodeLine{45         \textcolor{comment}{/* Helper functions for synthetic turbulent field models */}}
\DoxyCodeLine{46         \textcolor{comment}{// Check the grid properties before the FFT procedure}}
\DoxyCodeLine{47         \textcolor{keyword}{static} \textcolor{keywordtype}{void} checkGridRequirements(ref\_ptr<Grid3f> grid, \textcolor{keywordtype}{double} lMin,}
\DoxyCodeLine{48                                           \textcolor{keywordtype}{double} lMax);}
\DoxyCodeLine{49         \textcolor{comment}{// Execute inverse discrete FFT in-\/place for a 3D grid, from complex to real}}
\DoxyCodeLine{50         \textcolor{comment}{// space}}
\DoxyCodeLine{51         \textcolor{keyword}{static} \textcolor{keywordtype}{void} executeInverseFFTInplace(ref\_ptr<Grid3f> grid,}
\DoxyCodeLine{52                                              fftwf\_complex *Bkx, fftwf\_complex *Bky,}
\DoxyCodeLine{53                                              fftwf\_complex *Bkz);}
\DoxyCodeLine{54 }
\DoxyCodeLine{55         \textcolor{comment}{// Usefull checks for a grid field}}
\DoxyCodeLine{57 \textcolor{comment}{}        Vector3f getMeanFieldVector() \textcolor{keyword}{const};}
\DoxyCodeLine{59         \textcolor{keywordtype}{double} getMeanFieldStrength() \textcolor{keyword}{const};}
\DoxyCodeLine{61         \textcolor{keywordtype}{double} getRmsFieldStrength() \textcolor{keyword}{const};}
\DoxyCodeLine{63         std::array<float, 3> getRmsFieldStrengthPerAxis() \textcolor{keyword}{const};}
\DoxyCodeLine{65         std::vector<std::pair<int, float>> getPowerSpectrum() \textcolor{keyword}{const};}
\DoxyCodeLine{67         \textcolor{keywordtype}{void} dumpToFile(std::string filename) \textcolor{keyword}{const};}
\DoxyCodeLine{68 \};}
\DoxyCodeLine{69 }
\DoxyCodeLine{71 \} \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_HAVE\_FFTW3F}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_GRIDTURBULENCE\_H}}

\end{DoxyCode}
