\hypertarget{classcrpropa_1_1JF12FieldSolenoidal}{}\doxysection{JF12\+Field\+Solenoidal Class Reference}
\label{classcrpropa_1_1JF12FieldSolenoidal}\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}}


\mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal}{JF12\+Field\+Solenoidal}} galactic magnetic field model.  


Inheritance diagram for JF12\+Field\+Solenoidal\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=4.000000cm]{classcrpropa_1_1JF12FieldSolenoidal}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a3b32b78f720abb63da40654c0f2a52f4}{JF12\+Field\+Solenoidal}} (double delta=3 $\ast$kpc, double zs=0.\+5 $\ast$kpc)
\item 
void \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_afa03dc04ae480b9c822692c580c6249c}{set\+Use\+Striated\+Field}} (bool use)
\item 
void \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_ab0e1f71aaf5767b6cbd8d1573fe2dc34}{set\+Use\+Turbulent\+Field}} (bool use)
\item 
void \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a8df94792f850c1390852805e1e3afdaa}{set\+Disk\+Transition\+Width}} (double delta)
\begin{DoxyCompactList}\small\item\em Adjust the transition width of the disk field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a3d58e76942281a15a9c11796bb5ebf2a}\label{classcrpropa_1_1JF12FieldSolenoidal_a3d58e76942281a15a9c11796bb5ebf2a}} 
double {\bfseries get\+Disk\+Transition\+Width} () const
\item 
void \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a68c63b7ecb31850d0d1c95963072fd8d}{set\+XScale\+Height}} (double zs)
\begin{DoxyCompactList}\small\item\em Adjust the scale heigth of the X field. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a1125136ab7f34da778b380b2d34e427c}\label{classcrpropa_1_1JF12FieldSolenoidal_a1125136ab7f34da778b380b2d34e427c}} 
double {\bfseries get\+XScale\+Height} () const
\item 
\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a5d01ce3fd0a3e897dbfe22c3ef5ce41e}{get\+XField}} (const double \&r, const double \&z, const double \&sin\+Phi, const double \&cos\+Phi) const
\item 
\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a89e2ab1f78b81c71c37012156a11fb39}{get\+Disk\+Field}} (const double \&r, const double \&z, const double \&phi, const double \&sin\+Phi, const double \&cos\+Phi) const
\item 
void \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_ae676ee9f1ce661e04afd3935b91daefb}{deactivate\+Outer\+Transition}} ()
\begin{DoxyCompactList}\small\item\em Disable the transition of the spiral field strength to 0 at the outer boundary such that only the magnetic flux at the 5 kpc ring is redirected. Thus, the spiral field lines are continued to r = 20 kpc as in the initial JF12 field. You can reactivate the outer transition afterwards via set\+Disk\+Transition\+Width which sets both transition widths at the inner and outer boundary. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a474768fcad3536c2f402e3925eec5e15}{get\+Disk\+Transition\+Polynomial}} (const double \&r) const
\begin{DoxyCompactList}\small\item\em Evaluate the polynomial which provides the transition of the spiral field strength to zero in the transition regions. This transition is differentiable at the boundaries of the unaltered spiral field and contuinuous at the outer boundaries of the spiral field where the field strength goes to zero. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a2db63fef2469b5fd3100b8f8fd03c7f5}{get\+Disk\+Transition\+Polynomial\+Derivative}} (const double \&r) const
\begin{DoxyCompactList}\small\item\em Evaluate the derivative of the polynomial which provides the transition of the spiral field strength to zero in the transition regions. The derivative is needed to restore solenoidality in the transition region. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_ae5053c1cf86e9648d4c0b72671dfd965}{get\+HPhi\+Integral}} (const double \&r, const double \&phi) const
\begin{DoxyCompactList}\small\item\em Evaluate an angular azimuth integral over the piecewise constant spiral field strengths at r\+\_\+1 = 5 kpc. This integral is needed to restore the solenoidality of the spiral field in the transition regions. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal_a7f3a5fc09d90f399b78c8f6173cf4aae}{get\+Spiral\+Field\+Strength\+Constant}} (const double \&r, const double \&phi) const
\begin{DoxyCompactList}\small\item\em Find the correct magnetic spiral arm for the current position and return its field strength at r\+\_\+1 = 5 kpc. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a2d57377d7f105bce917f15132abf0ad7}\label{classcrpropa_1_1JF12Field_a2d57377d7f105bce917f15132abf0ad7}} 
void {\bfseries random\+Striated} (int seed=0)
\item 
void \mbox{\hyperlink{classcrpropa_1_1JF12Field_a8cb275c1344647266e85a679d44abf24}{set\+Striated\+Grid}} (\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1Grid}{Grid1f}} $>$ grid)
\item 
void \mbox{\hyperlink{classcrpropa_1_1JF12Field_abc09924adf731be01ce5e484e534e58d}{set\+Turbulent\+Grid}} (\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1Grid}{Grid3f}} $>$ grid)
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a74b7b87b78d25cfc714b649aed5b30df}\label{classcrpropa_1_1JF12Field_a74b7b87b78d25cfc714b649aed5b30df}} 
\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1Grid}{Grid1f}} $>$ {\bfseries get\+Striated\+Grid} ()
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a592be4b353afc6d12dec48de8e2f441a}\label{classcrpropa_1_1JF12Field_a592be4b353afc6d12dec48de8e2f441a}} 
\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1Grid}{Grid3f}} $>$ {\bfseries get\+Turbulent\+Grid} ()
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_ae0fee5decb3ed025b9960eace444a7f6}\label{classcrpropa_1_1JF12Field_ae0fee5decb3ed025b9960eace444a7f6}} 
void {\bfseries set\+Use\+Regular\+Field} (bool use)
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a3bce51e9a444d205eb1d1fee744604c3}\label{classcrpropa_1_1JF12Field_a3bce51e9a444d205eb1d1fee744604c3}} 
void {\bfseries set\+Use\+Disk\+Field} (bool use)
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a8647f653dc81204bfc798c937bc07f86}\label{classcrpropa_1_1JF12Field_a8647f653dc81204bfc798c937bc07f86}} 
void {\bfseries set\+Use\+Toroidal\+Halo\+Field} (bool use)
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a9e1d89282e3212200ff071926016f596}\label{classcrpropa_1_1JF12Field_a9e1d89282e3212200ff071926016f596}} 
void {\bfseries set\+Use\+XField} (bool use)
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_aaa172e99776155ef3059c18a524a8a37}\label{classcrpropa_1_1JF12Field_aaa172e99776155ef3059c18a524a8a37}} 
bool {\bfseries is\+Using\+Regular\+Field} ()
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a8888cb06a29d2e014a70ba3340e5b275}\label{classcrpropa_1_1JF12Field_a8888cb06a29d2e014a70ba3340e5b275}} 
bool {\bfseries is\+Using\+Striated\+Field} ()
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a0f3fe3fdbd9f165e6e56be85c62cf33f}\label{classcrpropa_1_1JF12Field_a0f3fe3fdbd9f165e6e56be85c62cf33f}} 
bool {\bfseries is\+Using\+Turbulent\+Field} ()
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a86f450bd05faf27153917f55ea022666}\label{classcrpropa_1_1JF12Field_a86f450bd05faf27153917f55ea022666}} 
bool {\bfseries is\+Using\+Disk\+Field} ()
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a37150cddef3c7ceb305b7b9cd8538f0b}\label{classcrpropa_1_1JF12Field_a37150cddef3c7ceb305b7b9cd8538f0b}} 
bool {\bfseries is\+Using\+Toroidal\+Halo\+Field} ()
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a9fa18f762b3355c2591a9ee7eb1d5f25}\label{classcrpropa_1_1JF12Field_a9fa18f762b3355c2591a9ee7eb1d5f25}} 
bool {\bfseries is\+Using\+XField} ()
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_ae44c8702c3f2b1a1ce5373ca459a548a}\label{classcrpropa_1_1JF12Field_ae44c8702c3f2b1a1ce5373ca459a548a}} 
double {\bfseries logistic\+Function} (const double \&x, const double \&x0, const double \&w) const
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a05d4b30271068bd7f27c5c805f384519}\label{classcrpropa_1_1JF12Field_a05d4b30271068bd7f27c5c805f384519}} 
\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} {\bfseries get\+Regular\+Field} (const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&pos) const
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a2d52ddb3ecc5641acb2d9422acb2ee31}\label{classcrpropa_1_1JF12Field_a2d52ddb3ecc5641acb2d9422acb2ee31}} 
\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} {\bfseries get\+Toroidal\+Halo\+Field} (const double \&r, const double \&z, const double \&sin\+Phi, const double \&cos\+Phi) const
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_ac5a5f59fdfa2eeb10aca68f86caf01fa}\label{classcrpropa_1_1JF12Field_ac5a5f59fdfa2eeb10aca68f86caf01fa}} 
\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} {\bfseries get\+Striated\+Field} (const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&pos) const
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a4cbb62223e839f70d02a3f412f951b10}\label{classcrpropa_1_1JF12Field_a4cbb62223e839f70d02a3f412f951b10}} 
double {\bfseries get\+Turbulent\+Strength} (const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&pos) const
\item 
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a2dc4428834e7395c8041b2000941f222}\label{classcrpropa_1_1JF12Field_a2dc4428834e7395c8041b2000941f222}} 
\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} {\bfseries get\+Turbulent\+Field} (const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&pos) const
\item 
\mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \mbox{\hyperlink{classcrpropa_1_1JF12Field_a60b4a9f66e692a5d3620de910bae981e}{get\+Field}} (const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&pos) const
\item 
\mbox{\Hypertarget{classcrpropa_1_1MagneticField_a3b26c25dd12606960327b3f186fae6cf}\label{classcrpropa_1_1MagneticField_a3b26c25dd12606960327b3f186fae6cf}} 
virtual \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} {\bfseries get\+Field} (const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&position, double z) const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Referenced_a6ef7442f4d857baf3d3a39fdeec4aadd}\label{classcrpropa_1_1Referenced_a6ef7442f4d857baf3d3a39fdeec4aadd}} 
size\+\_\+t {\bfseries add\+Reference} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Referenced_ab9f5dbbba1431274016b3d74426953f2}\label{classcrpropa_1_1Referenced_ab9f5dbbba1431274016b3d74426953f2}} 
size\+\_\+t {\bfseries remove\+Reference} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Referenced_adab41cca5664d4668930f93beefa39b5}\label{classcrpropa_1_1Referenced_adab41cca5664d4668930f93beefa39b5}} 
int {\bfseries remove\+Reference\+No\+Delete} () const
\item 
\mbox{\Hypertarget{classcrpropa_1_1Referenced_a74487fc4399bfa67c7251dae5d4247cd}\label{classcrpropa_1_1Referenced_a74487fc4399bfa67c7251dae5d4247cd}} 
size\+\_\+t {\bfseries get\+Reference\+Count} () const
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal}{JF12\+Field\+Solenoidal}} galactic magnetic field model. 

Implements a modified JF2012 Galactic magnetic field model. This implementation inherits most methods from the initial \mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12\+Field}}, just the regular disk field and the poloidal halo \char`\"{}\+X field\char`\"{} are altered.

A solenoidal transition for the disk field (which redirects the magnetic flux of the magnetic spiral field at the boundaries and lets the field strength tend to 0 in a continuous way) and an improved version of the JF12 X field (with parabolic field lines at z = 0 instead of sharp kinks) were added in order to smooth the field and avoid violations of magnetic flux conservation, see\+: Kleimann et al, 2018, ar\+Xiv\+:1809.\+07528, Solenoidal improvements for the JF12 Galactic magnetic field model.

The turbulent field component is the exact same as in the initial JF12 implementation and should be used with care since the new regular and old turbulent field do not match in the transition regions of the spiral field. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a3b32b78f720abb63da40654c0f2a52f4}\label{classcrpropa_1_1JF12FieldSolenoidal_a3b32b78f720abb63da40654c0f2a52f4}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{JF12FieldSolenoidal()}{JF12FieldSolenoidal()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1JF12FieldSolenoidal}{JF12\+Field\+Solenoidal}} (\begin{DoxyParamCaption}\item[{double}]{delta = {\ttfamily 3~$\ast$kpc},  }\item[{double}]{zs = {\ttfamily 0.5~$\ast$kpc} }\end{DoxyParamCaption})}

Constructor 
\begin{DoxyParams}{Parameters}
{\em delta} & Transition width for the disk field such that the magnetic flux of the spiral field lines is redirected between r = 5 kpc and r = 5 kpc + delta as well as r = 20 kpc -\/ delta and r = 20 kpc. The input parameter delta should be non-\/negative and smaller than 7.\+5 kpc. The default value is 3 kpc. \\
\hline
{\em zs} & Scale height for the X-\/shaped poloidal halo field such that the straight field lines are replaced by parabolas for abs(z) \texorpdfstring{$<$}{<} zs. The input parameter zs should be non-\/negative. The default value is 500 pc. \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_ae676ee9f1ce661e04afd3935b91daefb}\label{classcrpropa_1_1JF12FieldSolenoidal_ae676ee9f1ce661e04afd3935b91daefb}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!deactivateOuterTransition@{deactivateOuterTransition}}
\index{deactivateOuterTransition@{deactivateOuterTransition}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{deactivateOuterTransition()}{deactivateOuterTransition()}}
{\footnotesize\ttfamily void deactivate\+Outer\+Transition (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Disable the transition of the spiral field strength to 0 at the outer boundary such that only the magnetic flux at the 5 kpc ring is redirected. Thus, the spiral field lines are continued to r = 20 kpc as in the initial JF12 field. You can reactivate the outer transition afterwards via set\+Disk\+Transition\+Width which sets both transition widths at the inner and outer boundary. 

\begin{DoxyReturn}{Returns}
Void 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a89e2ab1f78b81c71c37012156a11fb39}\label{classcrpropa_1_1JF12FieldSolenoidal_a89e2ab1f78b81c71c37012156a11fb39}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!getDiskField@{getDiskField}}
\index{getDiskField@{getDiskField}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{getDiskField()}{getDiskField()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} get\+Disk\+Field (\begin{DoxyParamCaption}\item[{const double \&}]{r,  }\item[{const double \&}]{z,  }\item[{const double \&}]{phi,  }\item[{const double \&}]{sin\+Phi,  }\item[{const double \&}]{cos\+Phi }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12\+Field}}.

\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a474768fcad3536c2f402e3925eec5e15}\label{classcrpropa_1_1JF12FieldSolenoidal_a474768fcad3536c2f402e3925eec5e15}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!getDiskTransitionPolynomial@{getDiskTransitionPolynomial}}
\index{getDiskTransitionPolynomial@{getDiskTransitionPolynomial}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{getDiskTransitionPolynomial()}{getDiskTransitionPolynomial()}}
{\footnotesize\ttfamily double get\+Disk\+Transition\+Polynomial (\begin{DoxyParamCaption}\item[{const double \&}]{r }\end{DoxyParamCaption}) const}



Evaluate the polynomial which provides the transition of the spiral field strength to zero in the transition regions. This transition is differentiable at the boundaries of the unaltered spiral field and contuinuous at the outer boundaries of the spiral field where the field strength goes to zero. 


\begin{DoxyParams}{Parameters}
{\em r} & Distance of the current position to the z axis in the usual galactocentric cylindrical coordinates. Should be non-\/negative. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the transition polynomial at r if r is inside one of the transition regions. Otherwise, return (5 kpc)/r, i.\+e. the scaling of the spiral field, if r is inside the region where the spiral field remains unaltered. 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a2db63fef2469b5fd3100b8f8fd03c7f5}\label{classcrpropa_1_1JF12FieldSolenoidal_a2db63fef2469b5fd3100b8f8fd03c7f5}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!getDiskTransitionPolynomialDerivative@{getDiskTransitionPolynomialDerivative}}
\index{getDiskTransitionPolynomialDerivative@{getDiskTransitionPolynomialDerivative}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{getDiskTransitionPolynomialDerivative()}{getDiskTransitionPolynomialDerivative()}}
{\footnotesize\ttfamily double get\+Disk\+Transition\+Polynomial\+Derivative (\begin{DoxyParamCaption}\item[{const double \&}]{r }\end{DoxyParamCaption}) const}



Evaluate the derivative of the polynomial which provides the transition of the spiral field strength to zero in the transition regions. The derivative is needed to restore solenoidality in the transition region. 


\begin{DoxyParams}{Parameters}
{\em r} & Distance of the current position to the z axis in the usual galactocentric cylindrical coordinates. Should be non-\/negative. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the transition polynomial derivative at r if r is inside one of the transition regions. Otherwise, return 0. 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a60b4a9f66e692a5d3620de910bae981e}\label{classcrpropa_1_1JF12Field_a60b4a9f66e692a5d3620de910bae981e}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!getField@{getField}}
\index{getField@{getField}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{getField()}{getField()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} get\+Field (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} \&}]{pos }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}, {\ttfamily [inherited]}}



Reimplemented from \mbox{\hyperlink{classcrpropa_1_1MagneticField}{Magnetic\+Field}}.

\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_ae5053c1cf86e9648d4c0b72671dfd965}\label{classcrpropa_1_1JF12FieldSolenoidal_ae5053c1cf86e9648d4c0b72671dfd965}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!getHPhiIntegral@{getHPhiIntegral}}
\index{getHPhiIntegral@{getHPhiIntegral}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{getHPhiIntegral()}{getHPhiIntegral()}}
{\footnotesize\ttfamily double get\+HPhi\+Integral (\begin{DoxyParamCaption}\item[{const double \&}]{r,  }\item[{const double \&}]{phi }\end{DoxyParamCaption}) const}



Evaluate an angular azimuth integral over the piecewise constant spiral field strengths at r\+\_\+1 = 5 kpc. This integral is needed to restore the solenoidality of the spiral field in the transition regions. 


\begin{DoxyParams}{Parameters}
{\em r} & Distance of the current position to the z axis in the usual galactocentric cylindrical coordinates. Should be non-\/negative. \\
\hline
{\em phi} & Azimuth angle of the current position in galactocentric cylindrical coordinates. Can be any double. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the azimuth integral over the spiral field strengths at r\+\_\+1 = 5 kpc from at fixed phi0 to the current phi which is mapped back to r\+\_\+1 = 5 kpc along the spiral field line passing through (r,phi). 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a7f3a5fc09d90f399b78c8f6173cf4aae}\label{classcrpropa_1_1JF12FieldSolenoidal_a7f3a5fc09d90f399b78c8f6173cf4aae}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!getSpiralFieldStrengthConstant@{getSpiralFieldStrengthConstant}}
\index{getSpiralFieldStrengthConstant@{getSpiralFieldStrengthConstant}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{getSpiralFieldStrengthConstant()}{getSpiralFieldStrengthConstant()}}
{\footnotesize\ttfamily double get\+Spiral\+Field\+Strength\+Constant (\begin{DoxyParamCaption}\item[{const double \&}]{r,  }\item[{const double \&}]{phi }\end{DoxyParamCaption}) const}



Find the correct magnetic spiral arm for the current position and return its field strength at r\+\_\+1 = 5 kpc. 


\begin{DoxyParams}{Parameters}
{\em r} & Distance of the current position to the z axis in the usual galactocentric cylindrical coordinates. Should be non-\/negative. \\
\hline
{\em phi} & Azimuth angle of the current position in galactocentric cylindrical coordinates. Can be any double. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The value of the spiral field strength b\+\_\+j 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a5d01ce3fd0a3e897dbfe22c3ef5ce41e}\label{classcrpropa_1_1JF12FieldSolenoidal_a5d01ce3fd0a3e897dbfe22c3ef5ce41e}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!getXField@{getXField}}
\index{getXField@{getXField}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{getXField()}{getXField()}}
{\footnotesize\ttfamily \mbox{\hyperlink{classcrpropa_1_1Vector3}{Vector3d}} get\+XField (\begin{DoxyParamCaption}\item[{const double \&}]{r,  }\item[{const double \&}]{z,  }\item[{const double \&}]{sin\+Phi,  }\item[{const double \&}]{cos\+Phi }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12\+Field}}.

\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a8df94792f850c1390852805e1e3afdaa}\label{classcrpropa_1_1JF12FieldSolenoidal_a8df94792f850c1390852805e1e3afdaa}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!setDiskTransitionWidth@{setDiskTransitionWidth}}
\index{setDiskTransitionWidth@{setDiskTransitionWidth}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{setDiskTransitionWidth()}{setDiskTransitionWidth()}}
{\footnotesize\ttfamily void set\+Disk\+Transition\+Width (\begin{DoxyParamCaption}\item[{double}]{delta }\end{DoxyParamCaption})}



Adjust the transition width of the disk field. 


\begin{DoxyParams}{Parameters}
{\em d} & The new transition width for the disk field with field strength transitions and flux redirection between r = 5 kpc and r = 5 kpc + delta as well as r = 20 kpc -\/ delta and r = 20 kpc. Should be non-\/negative and smaller than 7.\+5 kpc. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void 
\end{DoxyReturn}
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_a8cb275c1344647266e85a679d44abf24}\label{classcrpropa_1_1JF12Field_a8cb275c1344647266e85a679d44abf24}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!setStriatedGrid@{setStriatedGrid}}
\index{setStriatedGrid@{setStriatedGrid}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{setStriatedGrid()}{setStriatedGrid()}}
{\footnotesize\ttfamily void set\+Striated\+Grid (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1Grid}{Grid1f}} $>$}]{grid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inherited]}}

Set a striated grid and activate the striated field component 
\begin{DoxyParams}{Parameters}
{\em grid} & scalar grid containing random +1/-\/1 values, 100 parsec grid spacing \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcrpropa_1_1JF12Field_abc09924adf731be01ce5e484e534e58d}\label{classcrpropa_1_1JF12Field_abc09924adf731be01ce5e484e534e58d}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!setTurbulentGrid@{setTurbulentGrid}}
\index{setTurbulentGrid@{setTurbulentGrid}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{setTurbulentGrid()}{setTurbulentGrid()}}
{\footnotesize\ttfamily void set\+Turbulent\+Grid (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classcrpropa_1_1ref__ptr}{ref\+\_\+ptr}}$<$ \mbox{\hyperlink{classcrpropa_1_1Grid}{Grid3f}} $>$}]{grid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inherited]}}

Set a turbulent grid and activate the turbulent field component 
\begin{DoxyParams}{Parameters}
{\em grid} & vector grid containing a random field of Brms = 1 \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_afa03dc04ae480b9c822692c580c6249c}\label{classcrpropa_1_1JF12FieldSolenoidal_afa03dc04ae480b9c822692c580c6249c}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!setUseStriatedField@{setUseStriatedField}}
\index{setUseStriatedField@{setUseStriatedField}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{setUseStriatedField()}{setUseStriatedField()}}
{\footnotesize\ttfamily void set\+Use\+Striated\+Field (\begin{DoxyParamCaption}\item[{bool}]{use }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12\+Field}}.

\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_ab0e1f71aaf5767b6cbd8d1573fe2dc34}\label{classcrpropa_1_1JF12FieldSolenoidal_ab0e1f71aaf5767b6cbd8d1573fe2dc34}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!setUseTurbulentField@{setUseTurbulentField}}
\index{setUseTurbulentField@{setUseTurbulentField}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{setUseTurbulentField()}{setUseTurbulentField()}}
{\footnotesize\ttfamily void set\+Use\+Turbulent\+Field (\begin{DoxyParamCaption}\item[{bool}]{use }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{classcrpropa_1_1JF12Field}{JF12\+Field}}.

\mbox{\Hypertarget{classcrpropa_1_1JF12FieldSolenoidal_a68c63b7ecb31850d0d1c95963072fd8d}\label{classcrpropa_1_1JF12FieldSolenoidal_a68c63b7ecb31850d0d1c95963072fd8d}} 
\index{JF12FieldSolenoidal@{JF12FieldSolenoidal}!setXScaleHeight@{setXScaleHeight}}
\index{setXScaleHeight@{setXScaleHeight}!JF12FieldSolenoidal@{JF12FieldSolenoidal}}
\doxysubsubsection{\texorpdfstring{setXScaleHeight()}{setXScaleHeight()}}
{\footnotesize\ttfamily void set\+XScale\+Height (\begin{DoxyParamCaption}\item[{double}]{zs }\end{DoxyParamCaption})}



Adjust the scale heigth of the X field. 


\begin{DoxyParams}{Parameters}
{\em zs} & The new scale height of the X field with parabolic field lines for abs(z) \texorpdfstring{$<$}{<} zs. Should be non-\/negative. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Void 
\end{DoxyReturn}
