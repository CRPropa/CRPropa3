\hypertarget{Common_8h_source}{}\doxysection{Common.\+h}
\label{Common_8h_source}\index{Common.h@{Common.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CRPROPA\_COMMON\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CRPROPA\_COMMON\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{11 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecrpropa}{crpropa}} \{}
\DoxyCodeLine{17 \textcolor{comment}{// Returns the full path to a CRPropa data file}}
\DoxyCodeLine{18 std::string getDataPath(std::string filename);}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{comment}{// Returns the install prefix}}
\DoxyCodeLine{21 std::string getInstallPrefix();}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{comment}{// Returns a certain digit from a given integer}}
\DoxyCodeLine{24 \textcolor{keyword}{inline} \textcolor{keywordtype}{int} digit(\textcolor{keyword}{const} \textcolor{keywordtype}{int}\& value, \textcolor{keyword}{const} \textcolor{keywordtype}{int}\& d) \{}
\DoxyCodeLine{25         \textcolor{keywordflow}{return} (value \% (d * 10)) / d;}
\DoxyCodeLine{26 \}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{comment}{// Return value xclip which is the closest to x, so that lower <= xclip <= upper}}
\DoxyCodeLine{29 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{30 T clip(\textcolor{keyword}{const} T\& x, \textcolor{keyword}{const} T\& lower, \textcolor{keyword}{const} T\& upper) \{}
\DoxyCodeLine{31         \textcolor{keywordflow}{return} std::max(lower, std::min(x, upper));}
\DoxyCodeLine{32 \}}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{comment}{// Perform linear interpolation on a set of n tabulated data points X[0 .. n-\/1] -\/> Y[0 .. n-\/1]}}
\DoxyCodeLine{35 \textcolor{comment}{// Returns Y[0] if x < X[0] and Y[n-\/1] if x > X[n-\/1]}}
\DoxyCodeLine{36 \textcolor{keywordtype}{double} interpolate(\textcolor{keywordtype}{double} x, \textcolor{keyword}{const} std::vector<double>\& X,}
\DoxyCodeLine{37                 \textcolor{keyword}{const} std::vector<double>\& Y);}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{comment}{// Perform bilinear interpolation on a set of (n,m) tabulated data points X[0 .. n-\/1], Y[0 .. m-\/1] -\/> Z[0.. n-\/1*m-\/1]}}
\DoxyCodeLine{41 \textcolor{comment}{// Returns 0 if x < X[0] or x > X[n-\/1] or y < Y[0] or y > Y[m-\/1]}}
\DoxyCodeLine{42 \textcolor{keywordtype}{double} interpolate2d(\textcolor{keywordtype}{double} x, \textcolor{keywordtype}{double} y, \textcolor{keyword}{const} std::vector<double>\& X,}
\DoxyCodeLine{43                 \textcolor{keyword}{const} std::vector<double>\& Y, \textcolor{keyword}{const} std::vector<double>\& Z);}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{comment}{// Perform linear interpolation on equidistant tabulated data}}
\DoxyCodeLine{46 \textcolor{comment}{// Returns Y[0] if x < lo and Y[n-\/1] if x > hi}}
\DoxyCodeLine{47 \textcolor{keywordtype}{double} interpolateEquidistant(\textcolor{keywordtype}{double} x, \textcolor{keywordtype}{double} lo, \textcolor{keywordtype}{double} hi,}
\DoxyCodeLine{48                 \textcolor{keyword}{const} std::vector<double>\& Y);}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{comment}{// Find index of value in a sorted vector X that is closest to x}}
\DoxyCodeLine{51 \textcolor{keywordtype}{size\_t} closestIndex(\textcolor{keywordtype}{double} x, \textcolor{keyword}{const} std::vector<double> \&X);}
\DoxyCodeLine{55 \textcolor{comment}{// pow implementation as template for integer exponents pow\_integer<2>(x)}}
\DoxyCodeLine{56 \textcolor{comment}{// evaluates to x*x}}
\DoxyCodeLine{57 \textcolor{keyword}{template} <\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} exponent>}
\DoxyCodeLine{58 \textcolor{keyword}{inline} \textcolor{keywordtype}{double} pow\_integer(\textcolor{keywordtype}{double} base)}
\DoxyCodeLine{59 \{}
\DoxyCodeLine{60   \textcolor{keywordflow}{return} pow\_integer<(exponent >> 1)>(base*base) * (((exponent \& 1) > 0) ? base : 1);}
\DoxyCodeLine{61 \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keyword}{template} <>}
\DoxyCodeLine{64 \textcolor{keyword}{inline} \textcolor{keywordtype}{double} pow\_integer<0>(\textcolor{keywordtype}{double} base)}
\DoxyCodeLine{65 \{}
\DoxyCodeLine{66   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{67 \}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{comment}{// -\/ input:  function over which to integrate, integration limits A and B}}
\DoxyCodeLine{70 \textcolor{comment}{// -\/ output: 8-\/points Gau√ü-\/Legendre integral}}
\DoxyCodeLine{71 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} X[8] = \{.0950125098, .2816035507, .4580167776, .6178762444, .7554044083, .8656312023, .9445750230, .9894009349\};}
\DoxyCodeLine{72 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double} W[8] = \{.1894506104, .1826034150, .1691565193, .1495959888, .1246289712, .0951585116, .0622535239, .0271524594\};}
\DoxyCodeLine{73 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Integrand>}
\DoxyCodeLine{74 \textcolor{keywordtype}{double} gaussInt(Integrand\&\& integrand, \textcolor{keywordtype}{double} A, \textcolor{keywordtype}{double} B) \{}
\DoxyCodeLine{75         \textcolor{keyword}{const} \textcolor{keywordtype}{double} XM = 0.5 * (B + A);}
\DoxyCodeLine{76         \textcolor{keyword}{const} \textcolor{keywordtype}{double} XR = 0.5 * (B -\/ A);}
\DoxyCodeLine{77         \textcolor{keywordtype}{double} SS = 0.;}
\DoxyCodeLine{78         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i) \{}
\DoxyCodeLine{79                 \textcolor{keywordtype}{double} DX = XR * X[i];}
\DoxyCodeLine{80                 SS += W[i] * (integrand(XM + DX) + integrand(XM -\/ DX));}
\DoxyCodeLine{81         \}}
\DoxyCodeLine{82         \textcolor{keywordflow}{return} XR * SS;}
\DoxyCodeLine{83 \}}
\DoxyCodeLine{84 }
\DoxyCodeLine{85 \} \textcolor{comment}{// namespace crpropa}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// CRPROPA\_COMMON\_H}}

\end{DoxyCode}
